{"version":3,"file":"connectRouter.js","sources":["../../../../node_modules/.pnpm/@babel+runtime@7.23.8/node_modules/@babel/runtime/helpers/esm/extends.js","../../src/connect-router/actions.ts","../../src/connect-router/reducer.ts","../../../../node_modules/.pnpm/@babel+runtime@7.23.8/node_modules/@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js","../../src/history/dom.ts","../../src/history/types.ts","../../src/history/utils.ts","../../../../node_modules/.pnpm/@babel+runtime@7.23.8/node_modules/@babel/runtime/helpers/esm/classCallCheck.js","../../../../node_modules/.pnpm/@babel+runtime@7.23.8/node_modules/@babel/runtime/helpers/esm/typeof.js","../../../../node_modules/.pnpm/@babel+runtime@7.23.8/node_modules/@babel/runtime/helpers/esm/toPrimitive.js","../../../../node_modules/.pnpm/@babel+runtime@7.23.8/node_modules/@babel/runtime/helpers/esm/toPropertyKey.js","../../../../node_modules/.pnpm/@babel+runtime@7.23.8/node_modules/@babel/runtime/helpers/esm/createClass.js","../../src/history/transitionManager.ts","../../src/history/waring.ts","../../src/history/baseHistory.ts","../../src/history/browerHistory.ts","../../src/history/hashHistory.ts","../../src/router/context.tsx","../../src/matcher/types.ts","../../src/matcher/utils.ts","../../src/matcher/lexer.ts","../../src/matcher/parser.ts","../../src/router/hooks.ts","../../src/router/Route.tsx","../../src/router/Router.tsx","../../src/router/Switch.tsx","../../src/router/lifeCycleHook.ts","../../src/router/Redirect.tsx","../../src/router/Prompt.tsx","../../src/router/withRouter.tsx","../../src/router/HashRouter.tsx","../../src/router/BrowserRouter.tsx","../../src/router/Link.tsx","../../src/router/NavLink.tsx","../../src/connect-router/reduxUtils.ts","../../src/connect-router/connectedRouter.tsx","../../src/connect-router/dispatch.ts","../../src/connect-router/index.ts","../../src/router/index2.ts"],"sourcesContent":["export default function _extends() {\n  _extends = Object.assign ? Object.assign.bind() : function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends.apply(this, arguments);\n}","import { Action, Path } from '../history/types';\r\n\r\ntype Location = Partial<Path>\r\n\r\n// 定义位置变化和history方法调用的Action type\r\nexport enum ActionName {\r\n  LOCATION_CHANGE = '$inula-router/LOCATION_CHANGE',\r\n  CALL_HISTORY_METHOD = '$inula-router/CALL_HISTORY_METHOD'\r\n}\r\n\r\n// 定义Action的两种数据类型\r\nexport type ActionMessage = {\r\n  type: ActionName.LOCATION_CHANGE\r\n  payload: {\r\n    location: Location,\r\n    action: Action\r\n    isFirstRendering: boolean\r\n  }\r\n} | {\r\n  type: ActionName.CALL_HISTORY_METHOD\r\n  payload: {\r\n    method: string,\r\n    args: any\r\n  }\r\n}\r\n\r\n\r\nexport const onLocationChanged = (location: Location, action: Action, isFirstRendering = false): ActionMessage => {\r\n  return {\r\n    type: ActionName.LOCATION_CHANGE,\r\n    payload: {\r\n      location,\r\n      action,\r\n      isFirstRendering,\r\n    },\r\n  };\r\n};\r\n\r\nconst updateLocation = (method: string): (...args: any) => ActionMessage => {\r\n  return (...args: any) => ({\r\n    type: ActionName.CALL_HISTORY_METHOD,\r\n    payload: {\r\n      method,\r\n      args,\r\n    },\r\n  });\r\n};\r\n\r\nexport const push = updateLocation('push');\r\nexport const replace = updateLocation('replace');\r\nexport const go = updateLocation('go');","import { ActionName } from './actions';\r\nimport { Action, History } from '../history/types';\r\nimport { Location } from '../router';\r\n\r\ntype LocationWithQuery = Partial<Location> & { query?: Record<string, any> };\r\n\r\n// 解析location对象，将其中的query参数解析并注入\r\nfunction injectQueryParams(location?: LocationWithQuery): LocationWithQuery {\r\n  if (location && location.query) {\r\n    return location;\r\n  }\r\n\r\n  const queryString = location && location.search;\r\n\r\n  if (!queryString) {\r\n    return {\r\n      ...location,\r\n      query: {},\r\n    };\r\n  }\r\n  const queryObject: Record<string, any> = {};\r\n\r\n  const params = new URLSearchParams(queryString);\r\n  params.forEach((value, key) => (queryObject[key] = value));\r\n\r\n  return {\r\n    ...location,\r\n    query: queryObject,\r\n  };\r\n}\r\n\r\ntype InitRouterState = {\r\n  location: LocationWithQuery;\r\n  action: Action;\r\n};\r\n\r\ntype Payload = {\r\n  type?: ActionName;\r\n  payload?: any;\r\n};\r\n\r\nexport function createConnectRouter() {\r\n  // 初始化redux State\r\n  return (history: History) => {\r\n    const initRouterState = {\r\n      location: injectQueryParams(history.location),\r\n      action: history.action,\r\n    };\r\n\r\n    // 定义connect-router对应的redux reducer函数\r\n    return (state: InitRouterState = initRouterState, { type, payload }: Payload = {}): any => {\r\n      if (type === ActionName.LOCATION_CHANGE) {\r\n        const { location, action, isFirstRendering } = payload;\r\n        if (isFirstRendering) {\r\n          return state;\r\n        }\r\n        return { ...state, location: injectQueryParams(location), action: action };\r\n      }\r\n      return state;\r\n    };\r\n  };\r\n}\r\n","export default function _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n  return target;\n}","export function isBrowser(): boolean {\r\n  return typeof window !== 'undefined' && window.document && typeof window.document.createElement === 'function';\r\n}\r\n\r\nexport function getDefaultConfirmation(message: string, callBack: (result: boolean) => void) {\r\n  callBack(window.confirm(message));\r\n}\r\n\r\n// 判断浏览器是否支持pushState方法，pushState是browserHistory实现的基础\r\nexport function isSupportHistory(): boolean {\r\n  return isBrowser() && window.history && 'pushState' in window.history;\r\n}\r\n\r\n// 判断浏览器是否支持PopState事件\r\nexport function isSupportsPopState(): boolean {\r\n  return window.navigator.userAgent.indexOf('Trident') === -1;\r\n}\r\n","export type BaseOption = {\r\n  basename?: string;\r\n  getUserConfirmation?: ConfirmationFunc;\r\n};\r\n\r\nexport interface HistoryProps<T = unknown> {\r\n  readonly action: Action;\r\n\r\n  readonly location: Location<T>;\r\n\r\n  length: number;\r\n}\r\n\r\nexport interface AgnosticHistory<T = unknown> extends HistoryProps<T> {\r\n  createHref(path: Partial<Path>): string;\r\n\r\n  push(to: To, state?: T): void;\r\n\r\n  replace(to: To, state?: T): void;\r\n\r\n  listen(listener: CommonListener<T>): () => void;\r\n\r\n  // add listener for listen pop action\r\n  addListener(listener: Listener<T>): () => void;\r\n\r\n  // cancel all pop listeners\r\n  destroy(): void;\r\n\r\n  block(prompt: Prompt<T>): () => void;\r\n\r\n  go(index: number): void;\r\n\r\n  goBack(): void;\r\n\r\n  goForward(): void;\r\n}\r\n\r\nexport type History<T = unknown> = Omit<AgnosticHistory<T>, 'addListener' | 'destroy'>;\r\n\r\nexport interface LocationHandler<T> {\r\n  locationHandler?: ((state?: Partial<HistoryState<T>>) => Location<T>) | null;\r\n  baseHandler?: (() => string) | null;\r\n}\r\n\r\nexport interface CreateLocationHandler<T> {\r\n  locationHandler?: ((basename: string) => (state?: Partial<HistoryState<T>>) => Location<T>) | null;\r\n  baseHandler?: ((basename: string) => () => string) | null;\r\n}\r\n\r\nexport enum Action {\r\n  pop = 'POP',\r\n  push = 'PUSH',\r\n  replace = 'REPLACE',\r\n}\r\n\r\nexport enum EventType {\r\n  PopState = 'popstate',\r\n  HashChange = 'hashchange',\r\n}\r\n\r\nexport enum PopDirection {\r\n  back = 'back',\r\n  forward = 'forward',\r\n  unknown = '',\r\n}\r\n\r\nexport type Path = {\r\n  pathname: string;\r\n\r\n  search: string;\r\n\r\n  hash: string;\r\n};\r\n\r\nexport type HistoryState<T> = {\r\n  state?: T;\r\n\r\n  key: string;\r\n};\r\n\r\nexport type DefaultStateType = unknown;\r\n\r\nexport type Location<T = unknown> = Path & HistoryState<T>;\r\n\r\nexport type To = string | Partial<Path>;\r\n\r\nexport interface CommonListener<T = unknown> {\r\n  (navigation: Navigation<T>): void;\r\n}\r\n\r\nexport interface ActionInfo {\r\n  type: Action;\r\n  direction: PopDirection;\r\n  delta: number;\r\n}\r\n\r\nexport interface PopListener {\r\n  (to: string, from: string, information: ActionInfo): void;\r\n}\r\n\r\nexport interface PopNavigation {\r\n  to: string;\r\n  from: string;\r\n  information: ActionInfo;\r\n}\r\n\r\nexport type Listener<S> =\r\n  | {\r\n      type: 'common';\r\n      listener: CommonListener<S>;\r\n    }\r\n  | {\r\n      type: 'pop';\r\n      listener: PopListener;\r\n    };\r\n\r\nexport interface Navigation<T = unknown> {\r\n  action: Action;\r\n\r\n  location: Location<T>;\r\n}\r\n\r\nexport type Prompt<S> = string | boolean | null | ((location: Location<S>, action: Action) => void);\r\n\r\nexport type CallBackFunc = (isJump: boolean) => void;\r\n\r\nexport type ConfirmationFunc = (message: string, callBack: CallBackFunc) => void;\r\n\r\nexport interface TManager<S> {\r\n  setPrompt(next: Prompt<S>): () => void;\r\n\r\n  confirmJumpTo(\r\n    location: Location<S>,\r\n    action: Action,\r\n    userConfirmationFunc: ConfirmationFunc,\r\n    callBack: CallBackFunc\r\n  ): void;\r\n}\r\n","import { Action, Location, Path, To } from './types';\r\n\r\nexport function createPath(path: Partial<Path>): string {\r\n  const { search, hash } = path;\r\n  let pathname = path.pathname || '/';\r\n  if (search && search !== '?') {\r\n    pathname += search.startsWith('?') ? search : '?' + search;\r\n  }\r\n  if (hash && hash !== '#') {\r\n    pathname += hash.startsWith('#') ? hash : '#' + hash;\r\n  }\r\n  return pathname;\r\n}\r\n\r\nexport function parsePath(url: string): Partial<Path> {\r\n  let pathname = url || '/';\r\n  const parsedPath: Partial<Path> = {\r\n    search: '',\r\n    hash: '',\r\n  };\r\n\r\n  const hashIdx = url.indexOf('#');\r\n  if (hashIdx > -1) {\r\n    const hash = url.substring(hashIdx);\r\n    parsedPath.hash = hash === '#' ? '' : hash;\r\n    pathname = pathname.substring(0, hashIdx);\r\n  }\r\n\r\n  const searchIdx = url.indexOf('?');\r\n  if (searchIdx > -1) {\r\n    const search = url.substring(searchIdx);\r\n    parsedPath.search = search === '?' ? '' : search;\r\n    pathname = pathname.substring(0, searchIdx);\r\n  }\r\n  parsedPath.pathname = pathname;\r\n  return parsedPath;\r\n}\r\n\r\nexport function createLocation<S>(current: string | Location, to: To, state?: S, key?: string): Readonly<Location<S>> {\r\n  const pathname = typeof current === 'string' ? current : current.pathname;\r\n  const urlObj = typeof to === 'string' ? parsePath(to) : to;\r\n  // 随机key长度取6\r\n  const getRandKey = genRandomKey(6);\r\n  const location = {\r\n    pathname: pathname,\r\n    search: '',\r\n    hash: '',\r\n    state: state,\r\n    key: typeof key === 'string' ? key : getRandKey(),\r\n    ...urlObj,\r\n  };\r\n  if (!location.pathname) {\r\n    location.pathname = pathname ? pathname : '/';\r\n  } else if (!location.pathname.startsWith('/')) {\r\n    location.pathname = parseRelativePath(location.pathname, pathname);\r\n  }\r\n  if (location.search && location.search[0] !== '?') {\r\n    location.search = '?' + location.search;\r\n  }\r\n  if (location.hash && location.hash[0] !== '#') {\r\n    location.hash = '#' + location.hash;\r\n  }\r\n  return location;\r\n}\r\n\r\nexport function isLocationEqual(p1: Partial<Path>, p2: Partial<Path>) {\r\n  return p1.pathname === p2.pathname && p1.search === p2.search && p1.hash === p2.hash;\r\n}\r\n\r\nexport function addHeadSlash(path: string): string {\r\n  if (path[0] === '/') {\r\n    return path;\r\n  }\r\n  return '/' + path;\r\n}\r\n\r\nexport function stripHeadSlash(path: string): string {\r\n  if (path[0] === '/') {\r\n    return path.substring(1);\r\n  }\r\n  return path;\r\n}\r\n\r\nexport function normalizeSlash(path: string): string {\r\n  const tempPath = addHeadSlash(path);\r\n  if (tempPath[tempPath.length - 1] === '/') {\r\n    return tempPath.substring(0, tempPath.length - 1);\r\n  }\r\n  return tempPath;\r\n}\r\n\r\nexport function hasBasename(path: string, prefix: string): boolean {\r\n  return (\r\n    path.toLowerCase().indexOf(prefix.toLowerCase()) === 0 && ['/', '?', '#', ''].includes(path.charAt(prefix.length))\r\n  );\r\n}\r\n\r\nexport function stripBasename(path: string, prefix: string): string {\r\n  return hasBasename(path, prefix) ? path.substring(prefix.length) : path;\r\n}\r\n\r\n// 使用随机生成的Key记录被访问过的URL，当Block被被触发时利用delta值跳转到之前的页面\r\nexport function createMemoryRecord<T, S>(initVal: S, fn: (arg: S) => T) {\r\n  let visitedRecord: T[] = [fn(initVal)];\r\n\r\n  function getDelta(to: S, from: S): number {\r\n    let toIdx = visitedRecord.lastIndexOf(fn(to));\r\n    if (toIdx === -1) {\r\n      toIdx = 0;\r\n    }\r\n    let fromIdx = visitedRecord.lastIndexOf(fn(from));\r\n    if (fromIdx === -1) {\r\n      fromIdx = 0;\r\n    }\r\n    return toIdx - fromIdx;\r\n  }\r\n\r\n  function addRecord(current: S, newRecord: S, action: Action) {\r\n    const curVal = fn(current);\r\n    const NewVal = fn(newRecord);\r\n    if (action === Action.push) {\r\n      const prevIdx = visitedRecord.lastIndexOf(curVal);\r\n      const newVisitedRecord = visitedRecord.slice(0, prevIdx + 1);\r\n      newVisitedRecord.push(NewVal);\r\n      visitedRecord = newVisitedRecord;\r\n    }\r\n    if (action === Action.replace) {\r\n      const prevIdx = visitedRecord.lastIndexOf(curVal);\r\n      if (prevIdx !== -1) {\r\n        visitedRecord[prevIdx] = NewVal;\r\n      }\r\n    }\r\n  }\r\n\r\n  return { getDelta, addRecord };\r\n}\r\n\r\nfunction genRandomKey(length: number): () => string {\r\n  const end = length + 2;\r\n  return () => {\r\n    return Math.random().toString(18).substring(2, end);\r\n  };\r\n}\r\n\r\nexport function parseRelativePath(to: string, from: string) {\r\n  if (to.startsWith('/')) {\r\n    return to;\r\n  }\r\n  const fromParts = from.split('/');\r\n  const toParts = to.split('/');\r\n  const lastToPart = toParts[toParts.length - 1];\r\n  if (lastToPart === '..' || lastToPart === '.') {\r\n    toParts.push('');\r\n  }\r\n  let index = fromParts.length - 1;\r\n  let toIndex = 0;\r\n  let urlPart: string;\r\n\r\n  while (toIndex < toParts.length) {\r\n    urlPart = toParts[toIndex];\r\n    if (urlPart === '.') {\r\n      continue;\r\n    }\r\n    if (urlPart === '..') {\r\n      if (index > 1) {\r\n        index--;\r\n      }\r\n      toIndex++;\r\n    } else {\r\n      break;\r\n    }\r\n  }\r\n  return fromParts.slice(0, index).join('/') + '/' + toParts.slice(toIndex).join('/');\r\n}\r\n","export default function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}","export default function _typeof(o) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) {\n    return typeof o;\n  } : function (o) {\n    return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o;\n  }, _typeof(o);\n}","import _typeof from \"./typeof.js\";\nexport default function toPrimitive(t, r) {\n  if (\"object\" != _typeof(t) || !t) return t;\n  var e = t[Symbol.toPrimitive];\n  if (void 0 !== e) {\n    var i = e.call(t, r || \"default\");\n    if (\"object\" != _typeof(i)) return i;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (\"string\" === r ? String : Number)(t);\n}","import _typeof from \"./typeof.js\";\nimport toPrimitive from \"./toPrimitive.js\";\nexport default function toPropertyKey(t) {\n  var i = toPrimitive(t, \"string\");\n  return \"symbol\" == _typeof(i) ? i : String(i);\n}","import toPropertyKey from \"./toPropertyKey.js\";\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, toPropertyKey(descriptor.key), descriptor);\n  }\n}\nexport default function _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  Object.defineProperty(Constructor, \"prototype\", {\n    writable: false\n  });\n  return Constructor;\n}","import type { Action, CallBackFunc, ConfirmationFunc, Location, Prompt, TManager } from './types';\r\n\r\nclass TransitionManager<S> implements TManager<S> {\r\n  private prompt: Prompt<S>;\r\n\r\n  constructor() {\r\n    this.prompt = null;\r\n  }\r\n\r\n  public setPrompt(prompt: Prompt<S>): () => void {\r\n    this.prompt = prompt;\r\n\r\n    // 清除Prompt\r\n    return () => {\r\n      if (this.prompt === prompt) {\r\n        this.prompt = null;\r\n      }\r\n    };\r\n  }\r\n\r\n  public confirmJumpTo(\r\n    location: Location<S>,\r\n    action: Action,\r\n    userConfirmationFunc: ConfirmationFunc,\r\n    callBack: CallBackFunc\r\n  ) {\r\n    if (this.prompt !== null) {\r\n      const result = typeof this.prompt === 'function' ? this.prompt(location, action) : this.prompt;\r\n      if (typeof result === 'string') {\r\n        typeof userConfirmationFunc === 'function' ? userConfirmationFunc(result, callBack) : callBack(true);\r\n      } else {\r\n        callBack(result !== false);\r\n      }\r\n    } else {\r\n      callBack(true);\r\n    }\r\n  }\r\n}\r\n\r\nexport default TransitionManager;\r\n","function warning(condition: any, message: string) {\r\n  if (condition) {\r\n    if (console && typeof console.warn === 'function') {\r\n      console.warn(message);\r\n    }\r\n  }\r\n}\r\n\r\nexport default warning;","import { Action, EventType, HistoryProps, Listener, Navigation, PopDirection, PopNavigation, Prompt } from './types';\r\nimport transitionManager from './transitionManager';\r\nimport { isSupportsPopState } from './dom';\r\nimport { createPath } from './utils';\r\n\r\ntype Trigger<S> =\r\n  | {\r\n      type: 'common';\r\n      trigger: (arg: Navigation<S>) => void;\r\n    }\r\n  | {\r\n      type: 'pop';\r\n      trigger: (arg: PopNavigation) => void;\r\n    };\r\n\r\n// 抽取BrowserHistory和HashHistory中相同的方法\r\nexport function getBaseHistory<S>(\r\n  type: 'browser' | 'hash' = 'browser',\r\n  transitionManager: transitionManager<S>,\r\n  popActionListener: (event: PopStateEvent | HashChangeEvent) => void\r\n) {\r\n  let listenerCount = 0;\r\n  const supportPopState = isSupportsPopState();\r\n  let listeners: Trigger<S>[] = [];\r\n  const unListeners: (() => void)[] = [];\r\n  const browserHistory = window.history;\r\n\r\n  // 标记是否暂停触发type为pop类型的listener\r\n  let pauseTrigger = false;\r\n\r\n  function go(step: number, triggerListener = true) {\r\n    if (triggerListener) {\r\n      pauseTrigger = true;\r\n    }\r\n    browserHistory.go(step);\r\n  }\r\n\r\n  function setupListener(count: number | null) {\r\n    if (count === null) {\r\n      listenerCount = 0;\r\n    } else {\r\n      listenerCount += count;\r\n    }\r\n    if (listenerCount === 1 && count === 1) {\r\n      if (type === 'browser' && supportPopState) {\r\n        addEventListener(EventType.PopState, popActionListener);\r\n      } else {\r\n        addEventListener(EventType.HashChange, popActionListener);\r\n      }\r\n    } else if (listenerCount === 0) {\r\n      if (type === 'browser' && supportPopState) {\r\n        removeEventListener(EventType.PopState, popActionListener);\r\n      } else {\r\n        removeEventListener(EventType.HashChange, popActionListener);\r\n      }\r\n    }\r\n  }\r\n\r\n  function addListener(listener: Listener<S>): () => void {\r\n    let isActive = true;\r\n    const wrapper = (args: Navigation<S> | PopNavigation) => {\r\n      if (isActive) {\r\n        if (listener.type === 'common' && 'action' in args) {\r\n          listener.listener(args);\r\n        } else if (listener.type === 'pop' && 'to' in args) {\r\n          listener.listener(args.to, args.from, args.information);\r\n        }\r\n      }\r\n    };\r\n    const trigger: Trigger<S> = { type: listener.type, trigger: wrapper };\r\n    listeners.push(trigger);\r\n    setupListener(1);\r\n\r\n    const cancelListener = () => {\r\n      isActive = false;\r\n      setupListener(-1);\r\n      listeners = listeners.filter(listener => listener !== trigger);\r\n    };\r\n\r\n    unListeners.push(cancelListener);\r\n    return cancelListener;\r\n  }\r\n\r\n  function destroy() {\r\n    for (const unListen of unListeners) {\r\n      unListen();\r\n    }\r\n    unListeners.length = 0;\r\n    setupListener(null);\r\n  }\r\n\r\n  let isBlocked = false;\r\n\r\n  function block(prompt: Prompt<S> = false): () => void {\r\n    const unblock = transitionManager.setPrompt(prompt);\r\n    if (!isBlocked) {\r\n      setupListener(1);\r\n      isBlocked = true;\r\n    }\r\n    return () => {\r\n      if (isBlocked) {\r\n        isBlocked = false;\r\n        setupListener(-1);\r\n      }\r\n      unblock();\r\n    };\r\n  }\r\n\r\n  function getUpdateStateFunc(historyProps: HistoryProps<S>) {\r\n    return function (nextState: Navigation<S> | undefined) {\r\n      const originPath = createPath(historyProps.location);\r\n      if (nextState) {\r\n        Object.assign(historyProps, nextState);\r\n      }\r\n      const delta = browserHistory.length - historyProps.length;\r\n      historyProps.length = browserHistory.length;\r\n      // 避免location引用相同时setState不触发\r\n      const location = Object.assign({}, historyProps.location);\r\n      const commonArgs = { location: location, action: historyProps.action };\r\n      const popArgs: PopNavigation = {\r\n        to: createPath(location),\r\n        from: originPath,\r\n        information: {\r\n          delta: delta,\r\n          direction: delta > 0 ? PopDirection.forward : PopDirection.back,\r\n          type: Action.pop,\r\n        },\r\n      };\r\n      for (let i = 0; i < listeners.length && !pauseTrigger; i++) {\r\n        const listener = listeners[i];\r\n        if (listener.type === 'common') {\r\n          listener.trigger(commonArgs);\r\n        } else if (listener.type === 'pop' && historyProps.action === Action.pop) {\r\n          // vue history listener only trigger when action is pop\r\n          listener.trigger(popArgs);\r\n        }\r\n      }\r\n      pauseTrigger = false;\r\n    };\r\n  }\r\n\r\n  return { go, addListener, block, destroy, getUpdateStateFunc };\r\n}\r\n","import { getDefaultConfirmation, isSupportHistory, isSupportsPopState } from './dom';\r\nimport {\r\n  Action,\r\n  AgnosticHistory,\r\n  BaseOption,\r\n  CommonListener,\r\n  DefaultStateType,\r\n  EventType,\r\n  History,\r\n  HistoryState,\r\n  Listener,\r\n  Location,\r\n  LocationHandler,\r\n  Path,\r\n  To,\r\n} from './types';\r\nimport { createLocation, createMemoryRecord, createPath, normalizeSlash, stripBasename } from './utils';\r\nimport TransitionManager from './transitionManager';\r\n\r\nimport warning from './waring';\r\nimport { getBaseHistory } from './baseHistory';\r\n\r\nexport type BrowserHistoryOption = {\r\n  /**\r\n   * forceRefresh为True时跳转时会强制刷新页面\r\n   */\r\n  forceRefresh?: boolean;\r\n} & BaseOption;\r\n\r\nexport function createBrowserHistory<S = DefaultStateType>(options: BrowserHistoryOption): History<S>;\r\n/**\r\n * @internal\r\n * @desc this override signature only for internal usage\r\n */\r\nexport function createBrowserHistory<S = DefaultStateType>(\r\n  options: LocationHandler<S> & BrowserHistoryOption\r\n): AgnosticHistory<S>;\r\nexport function createBrowserHistory<S = DefaultStateType>(\r\n  options: LocationHandler<S> & BrowserHistoryOption = {}\r\n): AgnosticHistory<S> {\r\n  const supportHistory = isSupportHistory();\r\n  const isSupportPopState = isSupportsPopState();\r\n  const browserHistory = window.history;\r\n  const { forceRefresh = false, getUserConfirmation = getDefaultConfirmation } = options;\r\n\r\n  const basename = options.basename ? normalizeSlash(options.basename) : '';\r\n\r\n  const initLocation = getLocation(getHistoryState());\r\n\r\n  const recordOperator = createMemoryRecord<string, Location<S>>(initLocation, l => l.key);\r\n\r\n  const transitionManager = new TransitionManager<S>();\r\n\r\n  const { go, addListener, block, destroy, getUpdateStateFunc } = getBaseHistory<S>(\r\n    'browser',\r\n    transitionManager,\r\n    handlePop\r\n  );\r\n\r\n  const listen = (listener: CommonListener<S>) => {\r\n    const trigger: Listener<S> = { type: 'common', listener: listener };\r\n    return addListener(trigger);\r\n  };\r\n\r\n  const history: AgnosticHistory<S> = {\r\n    action: Action.pop,\r\n    length: browserHistory.length,\r\n    location: initLocation,\r\n    go,\r\n    goBack: () => go(-1),\r\n    goForward: () => go(-1),\r\n    listen,\r\n    addListener,\r\n    block,\r\n    push,\r\n    replace,\r\n    destroy,\r\n    createHref,\r\n  };\r\n\r\n  const updateState = getUpdateStateFunc(history);\r\n\r\n  function getHistoryState() {\r\n    return supportHistory ? window.history.state : {};\r\n  }\r\n\r\n  function getLocation(historyState: Partial<HistoryState<S>>) {\r\n    const { search, hash } = window.location;\r\n    const { key, state } = historyState || {};\r\n    let pathname = window.location.pathname;\r\n    pathname = basename ? stripBasename(pathname, basename) : pathname;\r\n\r\n    return createLocation<S>('', { pathname, search, hash }, state, key);\r\n  }\r\n\r\n  // 拦截页面POP事件后，防止返回到的页面被重复拦截\r\n  let forceJump = false;\r\n\r\n  function handlePopState(location: Location<S>) {\r\n    if (forceJump) {\r\n      forceJump = false;\r\n      updateState(undefined);\r\n    } else {\r\n      const action = Action.pop;\r\n\r\n      const callback = (isJump: boolean) => {\r\n        if (isJump) {\r\n          // 执行跳转行为\r\n          updateState({ action: action, location: location });\r\n        } else {\r\n          revertPopState(location, history.location);\r\n        }\r\n      };\r\n\r\n      transitionManager.confirmJumpTo(location, action, getUserConfirmation, callback);\r\n    }\r\n  }\r\n\r\n  const isEventPopState = (event: Event): event is PopStateEvent => {\r\n    return event.type === EventType.PopState;\r\n  };\r\n\r\n  function handlePop(event: PopStateEvent | HashChangeEvent) {\r\n    const historyState = isSupportPopState && isEventPopState(event) ? event.state : getHistoryState();\r\n    const handler = options.locationHandler ? options.locationHandler : getLocation;\r\n    handlePopState(handler(historyState));\r\n  }\r\n\r\n  // 取消页面跳转并恢复到跳转前的页面\r\n  function revertPopState(from: Location<S>, to: Location<S>) {\r\n    const delta = recordOperator.getDelta(to, from);\r\n    if (delta !== 0) {\r\n      go(delta);\r\n      forceJump = true;\r\n    }\r\n  }\r\n\r\n  function createHref(path: Partial<Path>) {\r\n    return (options.baseHandler ? options.baseHandler() : basename) + createPath(path);\r\n  }\r\n\r\n  function push(to: To, state?: S) {\r\n    const action = Action.push;\r\n    const location = createLocation<S>(history.location, to, state, undefined);\r\n\r\n    transitionManager.confirmJumpTo(location, action, getUserConfirmation, isJump => {\r\n      if (!isJump) {\r\n        return;\r\n      }\r\n      const href = createHref(location);\r\n      const { key, state } = location;\r\n\r\n      if (supportHistory) {\r\n        if (forceRefresh) {\r\n          window.location.href = href;\r\n        } else {\r\n          browserHistory.pushState({ key: key, state: state }, '', href);\r\n          recordOperator.addRecord(history.location, location, action);\r\n          updateState({ action, location });\r\n        }\r\n      } else {\r\n        warning(state !== undefined, 'Browser history cannot push state in browsers that do not support HTML5 history');\r\n        window.location.href = href;\r\n      }\r\n    });\r\n  }\r\n\r\n  function replace(to: To, state?: S) {\r\n    const action = Action.replace;\r\n    const location = createLocation<S>(history.location, to, state, undefined);\r\n\r\n    transitionManager.confirmJumpTo(location, action, getUserConfirmation, isJump => {\r\n      if (!isJump) {\r\n        return;\r\n      }\r\n      const href = createHref(location);\r\n      const { key, state } = location;\r\n      if (supportHistory) {\r\n        if (forceRefresh) {\r\n          window.location.replace(href);\r\n        } else {\r\n          browserHistory.replaceState({ key: key, state: state }, '', href);\r\n          recordOperator.addRecord(history.location, location, action);\r\n          updateState({ action, location });\r\n        }\r\n      } else {\r\n        warning(state !== undefined, 'Browser history cannot push state in browsers that do not support HTML5 history');\r\n        window.location.replace(href);\r\n      }\r\n    });\r\n  }\r\n\r\n  return history;\r\n}\r\n","import { Action, AgnosticHistory, BaseOption, CommonListener, DefaultStateType, Listener, Location, To } from './types';\r\nimport {\r\n  addHeadSlash,\r\n  createLocation,\r\n  createMemoryRecord,\r\n  createPath,\r\n  isLocationEqual,\r\n  normalizeSlash,\r\n  stripBasename,\r\n  stripHeadSlash,\r\n} from './utils';\r\nimport { getDefaultConfirmation } from './dom';\r\nimport TransitionManager from './transitionManager';\r\n\r\nimport warning from './waring';\r\nimport { getBaseHistory } from './baseHistory';\r\n\r\nexport type urlHashType = 'slash' | 'noslash';\r\n\r\ntype HashHistoryOption = {\r\n  hashType?: urlHashType;\r\n} & BaseOption;\r\n\r\n// 获取#前的内容\r\nfunction stripHash(path: string): string {\r\n  const idx = path.indexOf('#');\r\n  return idx === -1 ? path : path.substring(0, idx);\r\n}\r\n\r\n// 获取#后的内容\r\nexport function getHashContent(path: string): string {\r\n  const idx = path.indexOf('#');\r\n  return idx === -1 ? '' : path.substring(idx + 1);\r\n}\r\n\r\nexport function createHashHistory<S = DefaultStateType>(option: HashHistoryOption = {}): AgnosticHistory<S> {\r\n  const browserHistory = window.history;\r\n  const { hashType = 'slash', getUserConfirmation = getDefaultConfirmation } = option;\r\n\r\n  const basename = option.basename ? normalizeSlash(option.basename) : '';\r\n\r\n  const pathDecoder = addHeadSlash;\r\n  const pathEncoder = hashType === 'slash' ? addHeadSlash : stripHeadSlash;\r\n\r\n  const startLocation = getHashContent(window.location.href);\r\n  const encodedLocation = pathEncoder(startLocation);\r\n  // 初始化hash格式不合法时会重定向\r\n  if (startLocation !== encodedLocation) {\r\n    window.location.replace(stripHash(window.location.href) + '#' + encodedLocation);\r\n  }\r\n\r\n  function getLocation() {\r\n    let hashPath = pathDecoder(getHashContent(window.location.hash));\r\n    if (basename) {\r\n      hashPath = stripBasename(hashPath, basename);\r\n    }\r\n\r\n    return createLocation<S>('', hashPath, undefined, 'default');\r\n  }\r\n\r\n  const initLocation = getLocation();\r\n\r\n  const memRecords = createMemoryRecord<string, Location<S>>(initLocation, createPath);\r\n\r\n  const transitionManager = new TransitionManager<S>();\r\n\r\n  function createHref(location: Location<S>) {\r\n    const tag = document.querySelector('base');\r\n    const base = tag && tag.getAttribute('href') ? stripHash(window.location.href) : '';\r\n    return base + '#' + pathEncoder(basename + createPath(location));\r\n  }\r\n\r\n  let forceNextPop = false;\r\n  let ignorePath: null | string = null;\r\n\r\n  const listen = (listener: CommonListener<S>) => {\r\n    const trigger: Listener<S> = { type: 'common', listener: listener };\r\n    return addListener(trigger);\r\n  };\r\n\r\n  const { go, addListener, block, destroy, getUpdateStateFunc } = getBaseHistory(\r\n    'hash',\r\n    transitionManager,\r\n    handleHashChange\r\n  );\r\n\r\n  const history: AgnosticHistory<S> = {\r\n    action: Action.pop,\r\n    length: browserHistory.length,\r\n    location: initLocation,\r\n    go,\r\n    goBack: () => go(-1),\r\n    goForward: () => go(1),\r\n    push,\r\n    replace,\r\n    listen,\r\n    addListener,\r\n    block,\r\n    destroy,\r\n    createHref,\r\n  };\r\n\r\n  const updateState = getUpdateStateFunc(history);\r\n\r\n  function push(to: To, state?: S) {\r\n    warning(state !== undefined, 'Hash history does not support state, it will be ignored');\r\n\r\n    const action = Action.push;\r\n    const location = createLocation<S>(history.location, to, state, '');\r\n\r\n    transitionManager.confirmJumpTo(location, action, getUserConfirmation, isJump => {\r\n      if (!isJump) {\r\n        return;\r\n      }\r\n      const path = createPath(location);\r\n      const encodedPath = pathEncoder(basename + path);\r\n      // 前后hash不一样才进行跳转\r\n      if (getHashContent(window.location.href) !== encodedPath) {\r\n        ignorePath = encodedPath;\r\n        window.location.hash = encodedPath;\r\n\r\n        memRecords.addRecord(history.location, location, action);\r\n\r\n        updateState({ action, location });\r\n      } else {\r\n        updateState(undefined);\r\n      }\r\n    });\r\n  }\r\n\r\n  function replace(to: To, state?: S) {\r\n    warning(state !== undefined, 'Hash history does not support state, it will be ignored');\r\n    const action = Action.replace;\r\n    const location = createLocation<S>(history.location, to, state, '');\r\n\r\n    transitionManager.confirmJumpTo(location, action, getUserConfirmation, isJump => {\r\n      if (!isJump) {\r\n        return;\r\n      }\r\n      const path = createPath(location);\r\n      const encodedPath = pathEncoder(basename + path);\r\n      if (getHashContent(window.location.href) !== encodedPath) {\r\n        ignorePath = path;\r\n        window.location.replace(stripHash(window.location.href) + '#' + encodedPath);\r\n      }\r\n      memRecords.addRecord(history.location, location, action);\r\n      updateState({ action, location });\r\n    });\r\n  }\r\n\r\n  function handleHashChange() {\r\n    const hashPath = getHashContent(window.location.href);\r\n    const encodedPath = pathEncoder(hashPath);\r\n    if (hashPath !== encodedPath) {\r\n      window.location.replace(stripHash(window.location.href) + '#' + encodedPath);\r\n    } else {\r\n      const location = getLocation();\r\n      const prevLocation = history.location;\r\n      if (!forceNextPop && isLocationEqual(location, prevLocation)) {\r\n        return;\r\n      }\r\n      if (ignorePath === createPath(location)) {\r\n        return;\r\n      }\r\n      ignorePath = null;\r\n      handlePopState(location);\r\n    }\r\n  }\r\n\r\n  function handlePopState(location: Location<S>) {\r\n    if (forceNextPop) {\r\n      forceNextPop = false;\r\n      updateState(undefined);\r\n    } else {\r\n      const action = Action.pop;\r\n\r\n      const callback = (isJump: boolean) => {\r\n        if (isJump) {\r\n          updateState({ action: action, location: location });\r\n        } else {\r\n          revertPopState(location);\r\n        }\r\n      };\r\n\r\n      transitionManager.confirmJumpTo(location, action, getUserConfirmation, callback);\r\n    }\r\n  }\r\n\r\n  // 在跳转行为被Block后，用History.go()跳转回之前的页面\r\n  function revertPopState(from: Location<S>) {\r\n    const to = history.location;\r\n    const delta = memRecords.getDelta(to, from);\r\n    if (delta !== 0) {\r\n      go(delta);\r\n      forceNextPop = true;\r\n    }\r\n  }\r\n\r\n  return history;\r\n}\r\n","import { createContext } from '@cloudsop/horizon';\r\nimport { History, Location } from './index';\r\nimport { Matched } from '../matcher/parser';\r\n\r\nfunction createNamedContext<T>(name: string, defaultValue: T) {\r\n  const context = createContext<T>(defaultValue);\r\n  context.displayName = name;\r\n  return context;\r\n}\r\n\r\nexport type RouterContextValue = {\r\n  history: History;\r\n  location: Location;\r\n  match: Matched | null;\r\n};\r\n\r\nconst RouterContext = createNamedContext<RouterContextValue>('Router', {} as any);\r\n\r\nexport default RouterContext;\r\n","/*\r\n * Copyright (c) 2020 Huawei Technologies Co.,Ltd.\r\n *\r\n * openInula is licensed under Mulan PSL v2.\r\n * You can use this software according to the terms and conditions of the Mulan PSL v2.\r\n * You may obtain a copy of Mulan PSL v2 at:\r\n *\r\n *          http://license.coscl.org.cn/MulanPSL2\r\n *\r\n * THIS SOFTWARE IS PROVIDED ON AN \"AS IS\" BASIS, WITHOUT WARRANTIES OF ANY KIND,\r\n * EITHER EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO NON-INFRINGEMENT,\r\n * MERCHANTABILITY OR FIT FOR A PARTICULAR PURPOSE.\r\n * See the Mulan PSL v2 for more details.\r\n */\r\n\r\nimport { Matched, Params } from './parser';\r\n\r\nexport type Token = {\r\n  type: TokenType;\r\n  value: string;\r\n};\r\n\r\nexport enum TokenType {\r\n  Delimiter = 'delimiter',\r\n  Static = 'static',\r\n  Param = 'param',\r\n  WildCard = 'wildcard',\r\n  LBracket = '(',\r\n  RBracket = ')',\r\n  Pattern = 'pattern',\r\n}\r\n\r\nexport interface Parser<P> {\r\n  regexp: RegExp;\r\n\r\n  keys: string[];\r\n\r\n  score: number[];\r\n\r\n  parse(url: string): Matched<P> | null;\r\n\r\n  compile(params: Params<P>): string;\r\n}\r\n\r\nexport type ParserOption = {\r\n  // 是否大小写敏感\r\n  caseSensitive?: boolean;\r\n  // 是否启用严格模式\r\n  strictMode?: boolean;\r\n  // 精准匹配 兼容 React-RouterV5\r\n  exact?: boolean;\r\n};\r\n\r\ntype ClearLeading<U extends string> = U extends `/${infer R}` ? ClearLeading<R> : U;\r\ntype ClearTailing<U extends string> = U extends `${infer L}/` ? ClearTailing<L> : U;\r\n\r\ntype ParseParam<Param extends string> = Param extends `:${infer R}`\r\n  ? {\r\n      [K in R]: string;\r\n    }\r\n  : {};\r\n\r\ntype MergeParams<OneParam extends Record<string, any>, OtherParam extends Record<string, any>> = {\r\n  readonly [Key in keyof OneParam | keyof OtherParam]?: string;\r\n};\r\n\r\ntype ParseURLString<Str extends string> = Str extends `${infer Param}/${infer Rest}`\r\n  ? MergeParams<ParseParam<Param>, ParseURLString<ClearLeading<Rest>>>\r\n  : ParseParam<Str>;\r\n\r\n// 解析URL中的动态参数，以实现TypeScript提示功能\r\nexport type GetURLParams<U extends string> = ParseURLString<ClearLeading<ClearTailing<U>>>;\r\n","/**\r\n * @description 将url中的//转换为/\r\n */\r\nexport function cleanPath(path: string): string {\r\n  return path.replace(/\\/+/g, '/');\r\n}\r\n\r\nexport function scoreCompare(score1: number[], score2: number[]): number {\r\n  const score1Length = score1.length;\r\n  const score2Length = score2.length;\r\n  const end = Math.min(score1Length, score2Length);\r\n  for (let i = 0; i < end; i++) {\r\n    const delta = score2[i] - score1[i];\r\n    if (delta !== 0) {\r\n      return delta;\r\n    }\r\n  }\r\n  if (score1Length === score2Length) {\r\n    return 0;\r\n  }\r\n  return score1Length > score2Length ? -1 : 1;\r\n}\r\n\r\n// 把正则表达式的特殊符号加两个反斜杠进行转义\r\nexport function escapeStr(str: string) {\r\n  return str.replace(/([.+*?=^!:${}()[\\]|/\\\\])/g, '\\\\$1');\r\n}\r\n","import { Token, TokenType } from './types';\r\nimport { cleanPath } from './utils';\r\n\r\nconst validChar = /[^/:()*?$^+]/;\r\n\r\n// 对Url模板进行词法解析，解析结果为Tokens\r\nexport function lexer(path: string): Token[] {\r\n  const tokens: Token[] = [];\r\n\r\n  if (!path) {\r\n    return tokens;\r\n  }\r\n\r\n  let urlPath = cleanPath(path);\r\n  if (urlPath !== '*' && !urlPath.startsWith('/')) {\r\n    throw new Error(`Url must start with \"/\".`);\r\n  }\r\n\r\n  const getLiteral = () => {\r\n    let name = '';\r\n    while (i < urlPath.length && validChar.test(urlPath[i])) {\r\n      name += urlPath[i];\r\n      skipChar(1);\r\n    }\r\n    return name;\r\n  };\r\n\r\n  const skipChar = (step: number) => {\r\n    i += step;\r\n  };\r\n\r\n  let i = 0;\r\n  while (i < urlPath.length) {\r\n    const curChar = urlPath[i];\r\n    const prevChar = urlPath[i - 1];\r\n\r\n    if (curChar === '/') {\r\n      tokens.push({ type: TokenType.Delimiter, value: urlPath[i] });\r\n      skipChar(1);\r\n      continue;\r\n    }\r\n    // dynamic params (/:a)\r\n    if (prevChar === '/' && curChar === ':') {\r\n      skipChar(1);\r\n      tokens.push({ type: TokenType.Param, value: getLiteral() });\r\n      continue;\r\n    }\r\n    // wildCard params (/:*)\r\n    if ((prevChar === '/' || prevChar === undefined) && curChar === '*') {\r\n      tokens.push({ type: TokenType.WildCard, value: urlPath[i] });\r\n      skipChar(1);\r\n      continue;\r\n    }\r\n    // static params\r\n    if (prevChar === '/' && validChar.test(curChar)) {\r\n      tokens.push({ type: TokenType.Static, value: getLiteral() });\r\n      continue;\r\n    }\r\n    if (curChar === '(') {\r\n      tokens.push({ type: TokenType.LBracket, value: '(' });\r\n      skipChar(1);\r\n      continue;\r\n    }\r\n    if (curChar === ')') {\r\n      tokens.push({ type: TokenType.RBracket, value: ')' });\r\n      skipChar(1);\r\n      continue;\r\n    }\r\n    if (['*', '?', '$', '^', '+'].includes(curChar)) {\r\n      tokens.push({ type: TokenType.Pattern, value: curChar });\r\n      skipChar(1);\r\n      continue;\r\n    }\r\n    if (validChar.test(curChar)) {\r\n      tokens.push({ type: TokenType.Pattern, value: getLiteral() });\r\n      continue;\r\n    }\r\n    // 跳过非法字符\r\n    skipChar(1);\r\n  }\r\n\r\n  return tokens;\r\n}\r\n","/*\r\n * Copyright (c) 2020 Huawei Technologies Co.,Ltd.\r\n *\r\n * openInula is licensed under Mulan PSL v2.\r\n * You can use this software according to the terms and conditions of the Mulan PSL v2.\r\n * You may obtain a copy of Mulan PSL v2 at:\r\n *\r\n *          http://license.coscl.org.cn/MulanPSL2\r\n *\r\n * THIS SOFTWARE IS PROVIDED ON AN \"AS IS\" BASIS, WITHOUT WARRANTIES OF ANY KIND,\r\n * EITHER EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO NON-INFRINGEMENT,\r\n * MERCHANTABILITY OR FIT FOR A PARTICULAR PURPOSE.\r\n * See the Mulan PSL v2 for more details.\r\n */\r\n\r\nimport { GetURLParams, Parser, ParserOption, TokenType } from './types';\r\nimport { lexer } from './lexer';\r\nimport { escapeStr, scoreCompare } from './utils';\r\n\r\n// 不同类型参数的匹配得分\r\nenum MatchScore {\r\n  // 固定参数\r\n  static = 10,\r\n  // 动态参数\r\n  param = 6,\r\n  // 通配符参数\r\n  wildcard = 3,\r\n  placeholder = -1,\r\n}\r\n\r\nexport type Params<P> = { [K in keyof P]?: P[K] };\r\n\r\n// 兼容 react v5 matched类型\r\nexport type Matched<P = any> = {\r\n  score: number[];\r\n  params: Params<P>;\r\n  path: string;\r\n  url: string;\r\n  isExact: boolean;\r\n};\r\n\r\nconst defaultOption: Required<ParserOption> = {\r\n  // url匹配时是否大小写敏感\r\n  caseSensitive: false,\r\n  // 是否严格匹配url结尾的/\r\n  strictMode: false,\r\n  // 是否完全精确匹配\r\n  exact: false,\r\n};\r\n// 正则表达式中需要转义的字符\r\nconst REGEX_CHARS_RE = /[.+*?^${}()[\\]/\\\\]/g;\r\n// 用于匹配两个//中的的值\r\nconst BASE_PARAM_PATTERN = '[^/]+';\r\n\r\nconst DefaultDelimiter = '/#?';\r\n\r\n/**\r\n * URL匹配整体流程\r\n * 1.词法解析，将URL模板解析为Token\r\n * 2.使用Token生成正则表达式\r\n * 3.利用正则表达式解析URL中参数或填充URL模板\r\n */\r\nexport function createPathParser<Str extends string>(pathname: Str, option?: ParserOption): Parser<GetURLParams<Str>>;\r\nexport function createPathParser<P = unknown>(pathname: string, option?: ParserOption): Parser<P>;\r\nexport function createPathParser<P = unknown>(pathname: string, option: ParserOption = defaultOption): Parser<P> {\r\n  const {\r\n    caseSensitive = defaultOption.caseSensitive,\r\n    strictMode = defaultOption.strictMode,\r\n    exact = defaultOption.exact,\r\n  } = option;\r\n\r\n  let pattern = '^';\r\n  const keys: string[] = [];\r\n  const scores: number[] = [];\r\n\r\n  const tokens = lexer(pathname);\r\n  const onlyHasWildCard = tokens.length === 1 && tokens[0].type === TokenType.WildCard;\r\n  const tokenCount = tokens.length;\r\n  const lastToken = tokens[tokenCount - 1];\r\n  let asteriskCount = 0;\r\n\r\n  /**\r\n   * 用于支持URL中的可选参数/:parma?\r\n   * @description 向前扫描到下一个分隔符/，检查其中是否有?\r\n   * @param currentIdx\r\n   */\r\n  const lookToNextDelimiter = (currentIdx: number): boolean => {\r\n    let hasOptionalParam = false;\r\n    while (currentIdx < tokens.length && tokens[currentIdx].type !== TokenType.Delimiter) {\r\n      if (tokens[currentIdx].value === '?' || tokens[currentIdx].value === '*') {\r\n        hasOptionalParam = true;\r\n      }\r\n      currentIdx++;\r\n    }\r\n    return hasOptionalParam;\r\n  };\r\n  for (let tokenIdx = 0; tokenIdx < tokenCount; tokenIdx++) {\r\n    const token = tokens[tokenIdx];\r\n    const nextToken = tokens[tokenIdx + 1];\r\n    switch (token.type) {\r\n      case TokenType.Delimiter: {\r\n        // 该分隔符后有可选参数则该分割符在匹配时是可选的\r\n        const hasOptional = lookToNextDelimiter(tokenIdx + 1);\r\n        // 该分隔符为最后一个且strictMode===false时，该分割符在匹配时是可选的\r\n        const isSlashOptional = nextToken === undefined && !strictMode;\r\n        pattern += `/${hasOptional || isSlashOptional ? '?' : ''}`;\r\n        break;\r\n      }\r\n      case TokenType.Static:\r\n        pattern += token.value.replace(REGEX_CHARS_RE, '\\\\$&');\r\n        if (nextToken && nextToken.type === TokenType.Pattern) {\r\n          pattern += `(.${nextToken.value})`;\r\n          keys.push(String(asteriskCount));\r\n          asteriskCount++;\r\n        }\r\n        scores.push(MatchScore.static);\r\n        break;\r\n      case TokenType.Param: {\r\n        // 动态参数支持形如/:param、/:param*、/:param?、/:param(\\\\d+)的形式\r\n        let paramRegexp = '';\r\n        if (nextToken) {\r\n          switch (nextToken.type) {\r\n            case TokenType.LBracket:\r\n              // 跳过当前Token和左括号\r\n              tokenIdx += 2;\r\n              while (tokens[tokenIdx].type !== TokenType.RBracket) {\r\n                paramRegexp += tokens[tokenIdx].value;\r\n                tokenIdx++;\r\n              }\r\n              paramRegexp = `(${paramRegexp})`;\r\n              break;\r\n            case TokenType.Pattern:\r\n              tokenIdx++;\r\n              paramRegexp += `(${nextToken.value === '*' ? '.*' : BASE_PARAM_PATTERN})${nextToken.value}`;\r\n              break;\r\n          }\r\n        }\r\n        pattern += paramRegexp ? `(?:${paramRegexp})` : `(${BASE_PARAM_PATTERN})`;\r\n        keys.push(token.value);\r\n        scores.push(MatchScore.param);\r\n        break;\r\n      }\r\n      case TokenType.WildCard:\r\n        keys.push(token.value);\r\n        pattern += `((?:${BASE_PARAM_PATTERN})${onlyHasWildCard ? '?' : ''}(?:/(?:${BASE_PARAM_PATTERN}))*)`;\r\n        scores.push(onlyHasWildCard ? MatchScore.wildcard : MatchScore.placeholder);\r\n        break;\r\n    }\r\n  }\r\n  const isWildCard = lastToken.type === TokenType.WildCard;\r\n\r\n  if (!isWildCard && !exact) {\r\n    if (!strictMode) {\r\n      pattern += `(?:[${escapeStr(DefaultDelimiter)}](?=$))?`;\r\n    }\r\n    if (lastToken.type !== TokenType.Delimiter) {\r\n      pattern += `(?=[${escapeStr(DefaultDelimiter)}]|$)`;\r\n    }\r\n  } else {\r\n    pattern += strictMode ? '$' : `[${escapeStr(DefaultDelimiter)}]?$`;\r\n  }\r\n\r\n  const flag = caseSensitive ? '' : 'i';\r\n  const regexp = new RegExp(pattern, flag);\r\n\r\n  /**\r\n   * @description 根据给定Pattern解析path\r\n   */\r\n  function parse(path: string): Matched<P> | null {\r\n    const reMatch = path.match(regexp);\r\n\r\n    if (!reMatch) {\r\n      return null;\r\n    }\r\n    const matchedPath = reMatch[0];\r\n    const params: Params<P> = {};\r\n    const parseScore: number[] = Array.from(scores);\r\n    for (let i = 1; i < reMatch.length; i++) {\r\n      const param = reMatch[i];\r\n      const key = keys[i - 1];\r\n      if (key === '*' && param) {\r\n        const value = param.split('/');\r\n        if (!Array.isArray(params['*'])) {\r\n          params['*'] = value;\r\n        } else {\r\n          params['*'].push(...value);\r\n        }\r\n        // 完成通配符参数解析后将placeholder替换为wildcard参数的分值\r\n        parseScore.splice(\r\n          scores.indexOf(MatchScore.placeholder),\r\n          1,\r\n          ...new Array(value.length).fill(MatchScore.wildcard)\r\n        );\r\n      } else {\r\n        params[key] = param ? param : undefined;\r\n      }\r\n    }\r\n\r\n    const isExact = path === matchedPath;\r\n    const url = path === '/' && matchedPath === '' ? '/' : matchedPath;\r\n    return { isExact: isExact, path: pathname, url: url, score: parseScore, params: params };\r\n  }\r\n\r\n  /**\r\n   * @description 使用给定参数填充pattern，得到目标URL\r\n   */\r\n  function compile(params: Params<P>): string {\r\n    let path = '';\r\n    for (const token of tokens) {\r\n      switch (token.type) {\r\n        case TokenType.Static:\r\n          path += token.value;\r\n          break;\r\n        case TokenType.Param:\r\n          if (!params[token.value]) {\r\n            throw new Error('Param is invalid.');\r\n          }\r\n          path += params[token.value];\r\n          break;\r\n        case TokenType.WildCard: {\r\n          const wildCard = params['*'];\r\n          if (wildCard instanceof Array) {\r\n            path += wildCard.join('/');\r\n          } else {\r\n            path += wildCard;\r\n          }\r\n          break;\r\n        }\r\n        case TokenType.Delimiter:\r\n          path += token.value;\r\n          break;\r\n      }\r\n    }\r\n    return path;\r\n  }\r\n\r\n  return {\r\n    regexp: regexp,\r\n    keys: keys,\r\n    score: scores,\r\n    compile,\r\n    parse,\r\n  };\r\n}\r\n\r\n/**\r\n * @description 依次使用pathname与pattern进行匹配，根据匹配分数取得分数最高结果\r\n */\r\nexport function matchPath<P = any>(\r\n  pathname: string,\r\n  pattern: string | string[],\r\n  option?: ParserOption\r\n): Matched<P> | null {\r\n  const patterns = Array.isArray(pattern) ? [...pattern] : [pattern];\r\n  const matchedResults: Matched<P>[] = [];\r\n  for (const item of patterns) {\r\n    const parser = createPathParser(item, option);\r\n    const matched = parser.parse(pathname);\r\n    if (matched) {\r\n      matchedResults.push(matched);\r\n    }\r\n  }\r\n  return !matchedResults.length ? null : matchedResults.sort((a, b) => scoreCompare(a.score, b.score))[0];\r\n}\r\n\r\nexport function generatePath<P = any>(path: string, params: Params<P>) {\r\n  const parser = createPathParser(path);\r\n  return parser.compile(params);\r\n}\r\n","import { useContext } from '@cloudsop/horizon';\r\nimport RouterContext from './context';\r\nimport { Matched, matchPath, Params } from '../matcher/parser';\r\nimport { History } from '../history/types';\r\nimport { Location } from './index';\r\n\r\nfunction useHistory<S>(): History<S>;\r\nfunction useHistory() {\r\n  return useContext(RouterContext).history;\r\n}\r\n\r\nfunction useLocation<S>(): Location<S>;\r\nfunction useLocation() {\r\n  return useContext(RouterContext).location;\r\n}\r\n\r\nfunction useParams<P>(): Params<P> | {};\r\nfunction useParams() {\r\n  const match = useContext(RouterContext).match;\r\n  return match ? match.params : {};\r\n}\r\n\r\nfunction useRouteMatch<P>(path?: string): Matched<P> | null;\r\nfunction useRouteMatch(path?: string) {\r\n  const pathname = useLocation().pathname;\r\n  const match = useContext(RouterContext).match;\r\n  if (path) {\r\n    return matchPath(pathname, path);\r\n  }\r\n  return match;\r\n}\r\n\r\nexport { useHistory, useLocation, useParams, useRouteMatch };\r\n","import Inula from '@cloudsop/horizon';\r\nimport { History, Location } from './index';\r\nimport { type Matched, matchPath } from '../matcher/parser';\r\nimport { useContext, Children, createElement, InulaNode, ComponentType } from '@cloudsop/horizon';\r\nimport RouterContext from './context';\r\nimport type { GetURLParams } from '../matcher/types';\r\n\r\nexport type RouteComponentProps<P extends Record<string, any> = {}, S = unknown> = RouteChildrenProps<P, S>;\r\n\r\nexport type RouteChildrenProps<P extends Record<string, any> = {}, S = unknown> = {\r\n  history: History<S>;\r\n  location: Location<S>;\r\n  match: Matched<P> | null;\r\n};\r\n\r\nexport type RouteProps<P extends Record<string, any> = {}, Path extends string = string> = {\r\n  location?: Location;\r\n  component?: ComponentType<RouteComponentProps<P>> | ComponentType<any> | undefined;\r\n  children?: ((props: RouteChildrenProps<P>) => InulaNode) | InulaNode;\r\n  render?: (props: RouteComponentProps<P>) => InulaNode;\r\n  path?: Path | Path[];\r\n  exact?: boolean;\r\n  sensitive?: boolean;\r\n  strict?: boolean;\r\n  computed?: Matched<P>;\r\n};\r\n\r\nfunction Route<Path extends string, P extends Record<string, any> = GetURLParams<Path>>(props: RouteProps<P, Path>) {\r\n  const context = useContext(RouterContext);\r\n\r\n  const { computed, location, path, component, render, strict, sensitive, exact } = props;\r\n  let { children } = props;\r\n  let match: Matched<P> | null;\r\n\r\n  const routeLocation = location || context.location;\r\n  if (computed) {\r\n    match = computed;\r\n  } else if (path) {\r\n    match = matchPath<P>(routeLocation.pathname, path, {\r\n      strictMode: strict,\r\n      caseSensitive: sensitive,\r\n      exact: exact,\r\n    });\r\n  } else {\r\n    match = context.match;\r\n  }\r\n  const newProps = { ...context, location: routeLocation, match: match };\r\n\r\n  if (Array.isArray(children) && Children.count(children) === 0) {\r\n    children = null;\r\n  }\r\n\r\n  /**\r\n   * 按顺序获取需要渲染的组件\r\n   * 1.children\r\n   * 2.component\r\n   * 3.render\r\n   * 都没有匹配到返回Null\r\n   */\r\n  const getChildren = (): InulaNode | null => {\r\n    // 如果 match 存在\r\n    if (newProps.match) {\r\n      if (children) {\r\n        if (typeof children === 'function') {\r\n          return children(newProps);\r\n        }\r\n        return children;\r\n      }\r\n\r\n      if (component) {\r\n        return createElement(component, newProps);\r\n      } else if (render) {\r\n        return render(newProps);\r\n      } else {\r\n        return null;\r\n      }\r\n    } else {\r\n      // match为null\r\n      if (typeof children === 'function') {\r\n        return children(newProps);\r\n      }\r\n      return null;\r\n    }\r\n  };\r\n\r\n  return <RouterContext.Provider value={newProps}>{getChildren()}</RouterContext.Provider>;\r\n}\r\n\r\nexport default Route;\r\n","import Inula from '@cloudsop/horizon';\r\nimport { useLayoutEffect, useMemo, useRef, useState, InulaNode } from '@cloudsop/horizon';\r\n\r\nimport { History, Location } from '../history/types';\r\n\r\nimport RouterContext, { RouterContextValue } from './context';\r\n\r\nexport type RouterProps = {\r\n  history: History;\r\n  children?: InulaNode;\r\n};\r\n\r\nfunction Router<P extends RouterProps>(props: P) {\r\n  const { history, children = null } = props;\r\n  const [location, setLocation] = useState(props.history.location);\r\n  const pendingLocation = useRef<Location | null>(null);\r\n  const unListen = useRef<null | (() => void)>(null);\r\n  const isMount = useRef<boolean>(false);\r\n\r\n  // 在Router加载时就监听history地址变化，以保证在始渲染时重定向能正确触发\r\n  if (unListen.current === null)\r\n    unListen.current = history.listen(arg => {\r\n      pendingLocation.current = arg.location;\r\n    });\r\n\r\n  // 模拟componentDidMount和componentWillUnmount\r\n  useLayoutEffect(() => {\r\n    isMount.current = true;\r\n    if (unListen.current) {\r\n      unListen.current();\r\n    }\r\n    // 监听history中的位置变化\r\n    unListen.current = history.listen(arg => {\r\n      if (isMount.current) {\r\n        setLocation(arg.location);\r\n      }\r\n    });\r\n\r\n    if (pendingLocation.current) {\r\n      setLocation(pendingLocation.current);\r\n    }\r\n\r\n    return () => {\r\n      if (unListen.current) {\r\n        isMount.current = false;\r\n        unListen.current();\r\n        unListen.current = null;\r\n        pendingLocation.current = null;\r\n      }\r\n    };\r\n  }, []);\r\n\r\n  const initContextValue: RouterContextValue = useMemo(\r\n    () => ({\r\n      history: history,\r\n      location: location,\r\n      match: { isExact: location.pathname === '/', params: {}, path: '/', score: [], url: '/' },\r\n    }),\r\n    [location],\r\n  );\r\n\r\n  return <RouterContext.Provider value={initContextValue} children={children} />;\r\n}\r\n\r\nexport default Router;\r\n","import Inula from '@cloudsop/horizon';\r\nimport { useContext, Children, isValidElement, cloneElement, InulaNode, InulaElement } from '@cloudsop/horizon';\r\n\r\nimport { Location } from './index';\r\nimport RouterContext from './context';\r\nimport { Matched, matchPath } from '../matcher/parser';\r\nimport type { RouteProps } from './Route';\r\nimport type { RedirectProps } from './Redirect';\r\n\r\nexport type SwitchProps = {\r\n  location?: Location;\r\n  children?: InulaNode;\r\n};\r\n\r\ntype MergeType<T1, T2> = { [K in keyof (T1 & T2)]: K extends keyof T1 ? T1[K] : K extends keyof T2 ? T2[K] : never };\r\n\r\nfunction Switch<P extends SwitchProps>(props: P): InulaElement | null {\r\n  const context = useContext(RouterContext);\r\n  const location = props.location || context.location;\r\n\r\n  let element: InulaElement | null = null;\r\n  let match: Matched | null = null;\r\n\r\n  // 使用forEach不会给React.ReactNode增加key属性,防止重新渲染\r\n  Children.forEach(props.children, node => {\r\n    if (match === null && isValidElement(node)) {\r\n      element = node;\r\n\r\n      const elementProps: MergeType<RouteProps, RedirectProps> = node.props;\r\n      const target = elementProps.path || elementProps.from;\r\n\r\n      // 更新匹配状态，一旦匹配到停止遍历\r\n      if (target) {\r\n        match = matchPath(location.pathname, target, {\r\n          strictMode: elementProps.strict,\r\n          caseSensitive: elementProps.sensitive,\r\n          exact: elementProps.exact,\r\n        });\r\n      } else {\r\n        match = context.match;\r\n      }\r\n    }\r\n  });\r\n\r\n  if (match && element) {\r\n    // 使用cloneElement复制已有组件并更新其Props\r\n    return cloneElement(element, { location: location, computed: match });\r\n  }\r\n  return null;\r\n}\r\n\r\nexport default Switch;\r\n","import { useLayoutEffect, useRef } from '@cloudsop/horizon';\r\n\r\nexport type LifeCycleProps = {\r\n  onMount?: () => void;\r\n  onUpdate?: (prevProps?: LifeCycleProps) => void;\r\n  onUnmount?: () => void;\r\n  data?: any;\r\n};\r\n\r\nexport function LifeCycle(props: LifeCycleProps) {\r\n  // 使用ref保存上一次的props，防止重新渲染\r\n  const prevProps = useRef<LifeCycleProps | null>(null);\r\n  const isMount = useRef(false);\r\n\r\n  const { onMount, onUpdate, onUnmount } = props;\r\n\r\n  useLayoutEffect(() => {\r\n    // 首次挂载 模拟componentDidMount\r\n    if (!isMount.current) {\r\n      isMount.current = true;\r\n      if (onMount) {\r\n        onMount();\r\n      }\r\n    } else {\r\n      // 不是首次渲染 模拟componentDidUpdate\r\n      if (onUpdate) {\r\n        prevProps.current ? onUpdate(prevProps.current) : onUpdate();\r\n      }\r\n    }\r\n    prevProps.current = props;\r\n  });\r\n\r\n  // 模拟componentWillUnmount\r\n  useLayoutEffect(() => {\r\n    return () => {\r\n      if (onUnmount) {\r\n        onUnmount();\r\n      }\r\n    };\r\n  }, []);\r\n\r\n  return null;\r\n}\r\n","import Inula from '@cloudsop/horizon';\r\nimport { useContext } from '@cloudsop/horizon';\r\nimport RouterContext from './context';\r\nimport { LifeCycle, LifeCycleProps } from './lifeCycleHook';\r\nimport { Matched, createPathParser } from '../matcher/parser';\r\nimport { addHeadSlash, isLocationEqual, parsePath } from '../history/utils';\r\nimport { Location } from './index';\r\n\r\nexport type RedirectProps = {\r\n  to: string | Partial<Location>;\r\n  push?: boolean;\r\n  path?: string;\r\n  from?: string;\r\n  exact?: boolean;\r\n  strict?: boolean;\r\n\r\n  // 由Switch计算得到\r\n  readonly computed?: Matched | null;\r\n};\r\n\r\nfunction Redirect<P extends RedirectProps>(props: P) {\r\n  const { to, push = false, computed } = props;\r\n\r\n  const context = useContext(RouterContext);\r\n  const { history } = context;\r\n\r\n  const calcLocation = (): Partial<Location> => {\r\n    if (computed) {\r\n      if (typeof to === 'string') {\r\n        const parser = createPathParser(to);\r\n        const target = parser.compile(computed.params);\r\n        return parsePath(target);\r\n      } else {\r\n        const pathname = to.pathname ? addHeadSlash(to.pathname) : '/';\r\n        const parser = createPathParser(pathname);\r\n        const target = parser.compile(computed.params);\r\n        return { ...to, pathname: target };\r\n      }\r\n    }\r\n    return typeof to === 'string' ? parsePath(to) : to;\r\n  };\r\n\r\n  const navigate = push ? history.push : history.replace;\r\n  const { state, ...path } = calcLocation();\r\n\r\n  const onMountFunc = () => {\r\n    navigate(path, state);\r\n  };\r\n\r\n  const onUpdateFunc = (prevProps?: LifeCycleProps) => {\r\n    // 如果当前页面与重定向前页面不一致，执行跳转\r\n    const prevPath = prevProps?.data as Location;\r\n    if (!isLocationEqual(prevPath, path)) {\r\n      navigate(path, state);\r\n    }\r\n  };\r\n\r\n  return <LifeCycle onMount={onMountFunc} onUpdate={onUpdateFunc} data={path} />;\r\n}\r\n\r\nexport default Redirect;\r\n","import Inula, { useRef } from '@cloudsop/horizon';\r\nimport { useContext } from '@cloudsop/horizon';\r\nimport { LifeCycle, LifeCycleProps } from './lifeCycleHook';\r\nimport { Location } from './index';\r\nimport { Action } from '../history/types';\r\nimport RouterContext from './context';\r\n\r\ntype PromptProps = {\r\n  message?: string | ((location: Partial<Location>, action: Action) => string | boolean);\r\n  when?: boolean | ((location: Partial<Location>) => boolean);\r\n};\r\n\r\nfunction Prompt<P extends PromptProps>(props: P) {\r\n  const context = useContext(RouterContext);\r\n\r\n  const { message, when = true } = props;\r\n\r\n  if ((typeof when === 'function' && when(context.location) === false) || !when) {\r\n    return null;\r\n  }\r\n\r\n  const navigate = context.history.block;\r\n\r\n  const release = useRef<(() => void) | null>(null);\r\n\r\n  const onMountFunc = () => {\r\n    release.current = message ? navigate(message) : null;\r\n  };\r\n\r\n  const onUpdateFunc = (prevProps?: LifeCycleProps) => {\r\n    if (prevProps && prevProps.data !== message) {\r\n      if (release.current) {\r\n        release.current();\r\n      }\r\n      release.current = message ? navigate(message) : null;\r\n    }\r\n  };\r\n\r\n  const onUnmountFunc = () => {\r\n    if (release.current) {\r\n      release.current();\r\n    }\r\n    release.current = null;\r\n  };\r\n\r\n  return <LifeCycle onMount={onMountFunc} onUpdate={onUpdateFunc} onUnmount={onUnmountFunc} data={message} />;\r\n}\r\n\r\nexport default Prompt;\r\n","import Inula from '@cloudsop/horizon';\r\nimport { useContext, ComponentType } from '@cloudsop/horizon';\r\nimport RouterContext from './context';\r\n\r\nfunction withRouter<C extends ComponentType>(Component: C) {\r\n  return function (props: any) {\r\n    const { wrappedComponentRef, ...rest } = props;\r\n    const context = useContext(RouterContext);\r\n\r\n    return <Component {...rest} {...context} ref={wrappedComponentRef} />;\r\n  };\r\n}\r\n\r\nexport default withRouter;\r\n","import Inula from '@cloudsop/horizon';\r\nimport { useRef } from '@cloudsop/horizon';\r\nimport { History } from '../history/types';\r\nimport { BaseRouterProps } from './BrowserRouter';\r\nimport { createHashHistory, urlHashType } from '../history/hashHistory';\r\nimport Router from './Router';\r\n\r\nexport type HashRouterProps = BaseRouterProps & {\r\n  hashType: urlHashType;\r\n};\r\n\r\nfunction HashRouter<P extends Partial<HashRouterProps>>(props: P) {\r\n  let historyRef = useRef<History>();\r\n  if (historyRef.current === null || historyRef.current === undefined) {\r\n    historyRef.current = createHashHistory({\r\n      basename: props.basename,\r\n      getUserConfirmation: props.getUserConfirmation,\r\n      hashType: props.hashType,\r\n    });\r\n  }\r\n\r\n  return <Router history={historyRef.current}>{props.children}</Router>;\r\n}\r\n\r\nexport default HashRouter;","import Inula from '@cloudsop/horizon';\r\nimport { useRef, InulaNode } from '@cloudsop/horizon';\r\nimport Router from './Router';\r\nimport { createBrowserHistory } from '../history/browerHistory';\r\nimport { ConfirmationFunc, History } from '../history/types';\r\n\r\nexport type BaseRouterProps = {\r\n  basename: string;\r\n  getUserConfirmation: ConfirmationFunc;\r\n  children?: InulaNode;\r\n};\r\n\r\nexport type BrowserRouterProps = BaseRouterProps & {\r\n  forceRefresh: boolean;\r\n};\r\n\r\nfunction BrowserRouter<P extends Partial<BrowserRouterProps>>(props: P) {\r\n  // 使用Ref持有History对象，防止重复渲染\r\n  let historyRef = useRef<History>();\r\n\r\n  if (historyRef.current === null || historyRef.current === undefined) {\r\n    historyRef.current = createBrowserHistory({\r\n      basename: props.basename,\r\n      forceRefresh: props.forceRefresh,\r\n      getUserConfirmation: props.getUserConfirmation,\r\n    });\r\n  }\r\n\r\n  return <Router history={historyRef.current}>{props.children}</Router>;\r\n}\r\n\r\nexport default BrowserRouter;","import Inula from '@cloudsop/horizon';\r\nimport { useContext, MouseEvent, ComponentType, Ref } from '@cloudsop/horizon';\r\nimport RouterContext from './context';\r\nimport { Location } from './index';\r\nimport { createPath, parsePath } from '../history/utils';\r\nimport { Path } from '../history/types';\r\n\r\nexport type LinkProps = {\r\n  component?: ComponentType<any>;\r\n  to: Partial<Location> | string | ((location: Location) => string | Partial<Location>);\r\n  replace?: boolean;\r\n  tag?: string;\r\n  /**\r\n   * @deprecated\r\n   * React16以后不再需要该属性\r\n   **/\r\n  innerRef?: Ref<HTMLAnchorElement>;\r\n} & { [key: string]: any };\r\n\r\nconst isModifiedEvent = (event: MouseEvent) => {\r\n  return event.metaKey || event.altKey || event.ctrlKey || event.shiftKey;\r\n};\r\n\r\nconst checkTarget = (target?: any) => {\r\n  return !target || target === '_self';\r\n};\r\n\r\n\r\nfunction Link<P extends LinkProps>(props: P) {\r\n  const { to, replace, component, onClick, target, ...other } = props;\r\n\r\n  const tag = props.tag || 'a';\r\n\r\n  const context = useContext(RouterContext);\r\n  const history = context.history;\r\n\r\n  let location = typeof to === 'function' ? to(context.location) : to;\r\n\r\n  let state: any;\r\n  let path: Partial<Path>;\r\n  if (typeof location === 'string') {\r\n    path = parsePath(location);\r\n  } else {\r\n    const { pathname, hash, search } = location;\r\n    path = { pathname, hash, search };\r\n    state = location.state;\r\n  }\r\n  const href = history.createHref(path);\r\n\r\n  const linkClickEvent = (event: MouseEvent<HTMLAnchorElement>) => {\r\n    try {\r\n      if (onClick) {\r\n        onClick(event);\r\n      }\r\n    } catch (e) {\r\n      event.preventDefault();\r\n      throw e;\r\n    }\r\n\r\n    if (!event.defaultPrevented && event.button === 0 && checkTarget(target) && !isModifiedEvent(event)) {\r\n      // 不是相同的路径执行push操作，是相同的路径执行replace\r\n      const isSamePath = createPath(context.location) === createPath(path);\r\n      const navigate = replace || isSamePath ? history.replace : history.push;\r\n      event.preventDefault();\r\n      navigate(path, state);\r\n    }\r\n  };\r\n\r\n  const linkProps = { href: href, onClick: linkClickEvent, ...other };\r\n  return Inula.createElement(tag, linkProps);\r\n}\r\n\r\nexport default Link;","import Inula from '@cloudsop/horizon';\r\nimport { useContext } from '@cloudsop/horizon';\r\nimport type { LinkProps } from './Link';\r\nimport Link from './Link';\r\nimport { Location, matchPath } from './index';\r\nimport { Matched } from '../matcher/parser';\r\nimport Context from './context';\r\nimport { parsePath } from '../history/utils';\r\n\r\ntype NavLinkProps = {\r\n  to: Partial<Location> | string | ((location: Location) => string | Partial<Location>);\r\n  isActive?<P extends { [K in keyof P]?: string }>(match: Matched<P> | null, location: Location): boolean;\r\n  exact?: boolean;\r\n  strict?: boolean;\r\n  sensitive?: boolean;\r\n  className?: string | ((isActive: boolean) => string);\r\n  activeClassName?: string;\r\n  // compat react-router NavLink props type\r\n  [key: string]: any;\r\n} & Omit<LinkProps, 'className'>;\r\n\r\ntype Page = 'page';\r\n\r\nfunction NavLink<P extends NavLinkProps>(props: P) {\r\n  const { to, isActive, exact, strict, sensitive, className, activeClassName, ...rest } = props;\r\n  const context = useContext(Context);\r\n\r\n  const toLocation = typeof to === 'function' ? to(context.location) : to;\r\n\r\n  const { pathname } = typeof toLocation === 'string' ? parsePath(toLocation) : toLocation;\r\n\r\n  const match = pathname\r\n    ? matchPath(context.location.pathname, pathname, {\r\n        exact: exact,\r\n        strictMode: strict,\r\n        caseSensitive: sensitive,\r\n      })\r\n    : null;\r\n\r\n  const isLinkActive = !!(isActive ? isActive(match, context.location) : match);\r\n\r\n  let classNames = typeof className === 'function' ? className(isLinkActive) : className;\r\n  if (isLinkActive) {\r\n    classNames = [activeClassName, classNames].filter(Boolean).join(' ');\r\n  }\r\n\r\n  const page: Page = 'page';\r\n  const otherProps = {\r\n    className: classNames,\r\n    'aria-current': isLinkActive ? page : undefined,\r\n    ...rest,\r\n  };\r\n\r\n  return <Link to={to} {...otherProps} />;\r\n}\r\n\r\nexport default NavLink;\r\n","import { Location } from '../router';\r\nimport { Action } from '../history/types';\r\n\r\n// 获取redux state中的值\r\nexport function getIn(state: Record<string, any>, path: string[]): any {\r\n  if (!state) {\r\n    return state;\r\n  }\r\n  const length = path.length;\r\n  if (!length) {\r\n    return undefined;\r\n  }\r\n  let res = state;\r\n  for (let i = 0; i < length && !!res; ++i) {\r\n    res = res[path[i]];\r\n  }\r\n  return res;\r\n}\r\n\r\n// 从store的state中获取Router、Location、Action、Hash等信息\r\nconst stateReader = (storeType: string) => {\r\n  const isRouter = (value: unknown) => {\r\n    return value !== null && typeof value === 'object' && !!getIn(value, ['location']) && !!getIn(value, ['action']);\r\n  };\r\n\r\n  const getRouter = (state: any) => {\r\n    const router = getIn(state, ['router']);\r\n    if (!isRouter(router)) {\r\n      throw new Error(`Could not find router reducer in ${storeType} store, it must be mounted under \"router\"`);\r\n    }\r\n    return router!;\r\n  };\r\n\r\n  const getLocation = <S>(state: any): Partial<Location<S>> => getIn(getRouter(state), ['location']);\r\n  const getAction = (state: any): Action => getIn(getRouter(state), ['action']);\r\n  const getSearch = (state: any): string => getIn(getRouter(state), ['location', 'search']);\r\n  const getHash = (state: any): string => getIn(getRouter(state), ['location', 'hash']);\r\n\r\n  return {\r\n    getHash,\r\n    getAction,\r\n    getSearch,\r\n    getRouter,\r\n    getLocation,\r\n  };\r\n};\r\n\r\nexport default stateReader","import Inula from '@cloudsop/horizon';\r\nimport { useLayoutEffect, useRef, reduxAdapter, InulaNode } from '@cloudsop/horizon';\r\nimport { connect, ReactReduxContext } from 'react-redux';\r\nimport type { Store } from 'redux';\r\nimport { History, Location, Router } from '../router';\r\nimport { Action, DefaultStateType, Navigation } from '../history/types';\r\nimport { ActionMessage, onLocationChanged } from './actions';\r\nimport stateReader from './reduxUtils';\r\n\r\ntype StoreType = 'InulaXCompat' | 'Redux';\r\n\r\ntype ConnectedRouter<S> = {\r\n  store: Store;\r\n  history: History<S>;\r\n  basename: string;\r\n  children?: (() => InulaNode) | InulaNode;\r\n  onLocationChanged: (location: Location<S>, action: Action, isFirstRendering: boolean) => ActionMessage;\r\n  noInitialPop: boolean;\r\n  omitRouter: boolean;\r\n  storeType: StoreType;\r\n};\r\n\r\nconst { connect: hConnect } = reduxAdapter;\r\n\r\nfunction ConnectedRouterWithoutMemo<S>(props: ConnectedRouter<S>) {\r\n  const { store, history, onLocationChanged, omitRouter, children, storeType } = props;\r\n  const { getLocation } = stateReader(storeType);\r\n\r\n  // 监听store变化\r\n  const unsubscribe = useRef<null | (() => void)>(\r\n    store.subscribe(() => {\r\n      // 获取redux State中的location信息\r\n      const {\r\n        pathname: pathnameInStore,\r\n        search: searchInStore,\r\n        hash: hashInStore,\r\n        state: stateInStore,\r\n      } = getLocation<S>(store.getState());\r\n\r\n      // 获取当前history对象中的location信息\r\n      const {\r\n        pathname: pathnameInHistory,\r\n        search: searchInHistory,\r\n        hash: hashInHistory,\r\n        state: stateInHistory,\r\n      } = history.location;\r\n\r\n      // 两个location不一致 执行跳转\r\n      if (\r\n        history.action === 'PUSH' &&\r\n        (pathnameInHistory !== pathnameInStore ||\r\n          searchInHistory !== searchInStore ||\r\n          hashInHistory !== hashInStore ||\r\n          stateInHistory !== stateInStore)\r\n      ) {\r\n        history.push(\r\n          {\r\n            pathname: pathnameInStore,\r\n            search: searchInStore,\r\n            hash: hashInStore,\r\n          },\r\n          stateInStore,\r\n        );\r\n      }\r\n    }),\r\n  );\r\n\r\n  const handleLocationChange = (args: Navigation<S>, isFirstRendering: boolean = false) => {\r\n    const { location, action } = args;\r\n    onLocationChanged(location, action, isFirstRendering);\r\n  };\r\n\r\n  // 监听history更新\r\n  const unListen = useRef<null | (() => void)>(history.listen(handleLocationChange));\r\n\r\n  useLayoutEffect(() => {\r\n    return () => {\r\n      unListen.current && unListen.current();\r\n      unsubscribe.current && unsubscribe.current();\r\n    };\r\n  }, []);\r\n\r\n  if (!props.noInitialPop) {\r\n    // 传递初始时位置信息，isFirstRendering设为true防止重复渲染\r\n    handleLocationChange({ location: history.location, action: history.action }, true);\r\n  }\r\n\r\n  if (omitRouter) {\r\n    return <>{children}</>;\r\n  }\r\n  let childrenNode: InulaNode;\r\n  if (typeof children === 'function') {\r\n    childrenNode = children();\r\n  } else {\r\n    childrenNode = children;\r\n  }\r\n\r\n  return <Router history={history}>{childrenNode}</Router>;\r\n}\r\n\r\nfunction getConnectedRouter<S = DefaultStateType>(type: StoreType) {\r\n  const mapDispatchToProps = (dispatch: any) => ({\r\n    onLocationChanged: (location: Location, action: Action, isFirstRendering: boolean) =>\r\n      dispatch(onLocationChanged(location, action, isFirstRendering)),\r\n  });\r\n  const ConnectedRouter = Inula.memo(ConnectedRouterWithoutMemo<S>);\r\n\r\n  const ConnectedRouterWithContext = (props: any) => {\r\n    const Context = props.context || ReactReduxContext;\r\n\r\n    return (\r\n      <Context.Consumer>\r\n        {({ store }: any) => <ConnectedRouter store={store} storeType={type} {...props} />}\r\n      </Context.Consumer>\r\n    );\r\n  };\r\n\r\n  const ConnectedHRouterWithContext = (props: any) => {\r\n    const { store, ...rest } = props;\r\n    return <ConnectedRouter store={store} storeType={type} {...rest} />;\r\n  };\r\n\r\n  // 针对不同的Store类型，使用对应的connect函数\r\n  if (type === 'InulaXCompat') {\r\n    return hConnect(null as any, mapDispatchToProps)(ConnectedHRouterWithContext as any);\r\n  }\r\n  if (type === 'Redux') {\r\n    return connect(null, mapDispatchToProps)(ConnectedRouterWithContext);\r\n  } else {\r\n    throw new Error('Invalid store type');\r\n  }\r\n}\r\n\r\nexport { getConnectedRouter };\r\n","import { ActionMessage, ActionName } from './actions';\r\nimport { History } from '../history/types';\r\n\r\n// 定义connect-router对应的redux dispatch函数\r\nexport function routerMiddleware(history: History) {\r\n  return function(_: any) {\r\n    return function(next: any) {\r\n      return function(action: ActionMessage) {\r\n        if (action.type !== ActionName.CALL_HISTORY_METHOD) {\r\n          return next(action);\r\n        }\r\n        const { payload: { method, args } } = action;\r\n        if (method in history) {\r\n          (history as any)[method](...args);\r\n        }\r\n      };\r\n    };\r\n  };\r\n}\r\n","import { createConnectRouter } from './reducer';\r\n\r\nexport { getConnectedRouter } from './connectedRouter';\r\nexport const connectRouter = createConnectRouter();\r\nexport { routerMiddleware } from './dispatch';\r\nexport { push, go, replace } from './actions';","import { Location as HLocation } from '../history/types';\r\nimport { getConnectedRouter } from '../connect-router';\r\n\r\ntype Location<S = unknown> = Omit<HLocation<S>, 'key'>;\r\n\r\n// ============================ history ============================\r\n\r\nexport type { Location };\r\nexport type { History } from '../history/types';\r\n\r\nexport { createBrowserHistory } from '../history/browerHistory';\r\nexport { createHashHistory } from '../history/hashHistory';\r\n\r\nexport { default as __RouterContext } from './context';\r\n\r\n// ============================ URL parser ============================\r\n\r\nexport { matchPath, generatePath } from '../matcher/parser';\r\n\r\n// ============================ Router Hooks ============================\r\n\r\nexport { useHistory, useLocation, useParams, useRouteMatch } from './hooks';\r\n\r\n// ============================ Router function component ============================\r\n\r\nexport { default as Route } from './Route';\r\nexport { default as Router } from './Router';\r\nexport { default as Switch } from './Switch';\r\nexport { default as Redirect } from './Redirect';\r\nexport { default as Prompt } from './Prompt';\r\nexport { default as withRouter } from './withRouter';\r\nexport { default as HashRouter } from './HashRouter';\r\nexport { default as BrowserRouter } from './BrowserRouter';\r\nexport { default as Link } from './Link';\r\nexport { default as NavLink } from './NavLink';\r\n\r\n// ============================ Router Types ============================\r\n\r\nexport type { RouteComponentProps, RouteChildrenProps, RouteProps } from './Route';\r\n\r\n// ============================ Connect-router ============================\r\n\r\nexport { connectRouter, routerMiddleware, push, go, replace } from '../connect-router';\r\nexport const ConnectedRouter = getConnectedRouter('Redux');\r\nexport const ConnectedHRouter = getConnectedRouter('InulaXCompat');\r\n"],"names":["_extends","Object","assign","bind","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","apply","ActionName","onLocationChanged","location","action","isFirstRendering","undefined","type","LOCATION_CHANGE","payload","updateLocation","method","_len","args","Array","_key","CALL_HISTORY_METHOD","push","replace","go","injectQueryParams","query","queryString","search","queryObject","params","URLSearchParams","forEach","value","createConnectRouter","history","initRouterState","state","_ref","_objectWithoutPropertiesLoose","excluded","sourceKeys","keys","indexOf","isBrowser","window","document","createElement","getDefaultConfirmation","message","callBack","confirm","isSupportHistory","isSupportsPopState","navigator","userAgent","Action","EventType","PopDirection","createPath","path","hash","pathname","startsWith","parsePath","url","parsedPath","hashIdx","substring","searchIdx","createLocation","current","to","urlObj","getRandKey","genRandomKey","parseRelativePath","isLocationEqual","p1","p2","addHeadSlash","stripHeadSlash","normalizeSlash","tempPath","hasBasename","prefix","toLowerCase","includes","charAt","stripBasename","createMemoryRecord","initVal","fn","visitedRecord","getDelta","from","toIdx","lastIndexOf","fromIdx","addRecord","newRecord","curVal","NewVal","prevIdx","newVisitedRecord","slice","end","Math","random","toString","fromParts","split","toParts","lastToPart","index","toIndex","urlPart","join","_classCallCheck","instance","Constructor","TypeError","_typeof","o","Symbol","iterator","constructor","toPrimitive","t","r","e","String","Number","toPropertyKey","_defineProperties","props","descriptor","enumerable","configurable","writable","defineProperty","_createClass","protoProps","staticProps","TransitionManager","prompt","setPrompt","_this","confirmJumpTo","userConfirmationFunc","result","warning","condition","console","warn","getBaseHistory","transitionManager","popActionListener","listenerCount","supportPopState","listeners","unListeners","browserHistory","pauseTrigger","step","triggerListener","setupListener","count","addEventListener","PopState","HashChange","removeEventListener","addListener","listener","isActive","wrapper","information","trigger","cancelListener","filter","destroy","_iterator","_createForOfIteratorHelper","_step","s","n","done","unListen","err","f","isBlocked","block","unblock","getUpdateStateFunc","historyProps","nextState","originPath","delta","commonArgs","popArgs","direction","forward","back","pop","createBrowserHistory","options","supportHistory","isSupportPopState","_options$forceRefresh","forceRefresh","_options$getUserConfi","getUserConfirmation","basename","initLocation","getLocation","getHistoryState","recordOperator","l","_getBaseHistory","handlePop","listen","goBack","goForward","createHref","updateState","historyState","_window$location","forceJump","handlePopState","callback","isJump","revertPopState","isEventPopState","event","handler","locationHandler","baseHandler","href","pushState","replaceState","stripHash","idx","getHashContent","createHashHistory","option","_option$hashType","hashType","_option$getUserConfir","pathDecoder","pathEncoder","startLocation","encodedLocation","hashPath","memRecords","tag","querySelector","base","getAttribute","forceNextPop","ignorePath","handleHashChange","encodedPath","prevLocation","createNamedContext","name","defaultValue","context","createContext","displayName","RouterContext","TokenType","cleanPath","scoreCompare","score1","score2","score1Length","score2Length","min","escapeStr","str","validChar","lexer","tokens","urlPath","Error","getLiteral","test","skipChar","curChar","prevChar","Delimiter","Param","WildCard","Static","LBracket","RBracket","Pattern","MatchScore","defaultOption","caseSensitive","strictMode","exact","REGEX_CHARS_RE","BASE_PARAM_PATTERN","DefaultDelimiter","createPathParser","_option$caseSensitive","_option$strictMode","_option$exact","pattern","scores","onlyHasWildCard","tokenCount","lastToken","asteriskCount","lookToNextDelimiter","currentIdx","hasOptionalParam","tokenIdx","token","nextToken","hasOptional","isSlashOptional","static","paramRegexp","param","wildcard","placeholder","isWildCard","flag","regexp","RegExp","parse","reMatch","match","matchedPath","parseScore","isArray","_params$","splice","concat","fill","isExact","score","compile","wildCard","matchPath","patterns","matchedResults","_iterator2","_step2","item","parser","matched","sort","a","b","generatePath","useHistory","useContext","useLocation","useParams","useRouteMatch","Route","computed","component","render","strict","sensitive","children","routeLocation","newProps","Children","getChildren","_jsx","Provider","Router","_props$children","_useState","useState","setLocation","pendingLocation","useRef","isMount","arg","useLayoutEffect","initContextValue","useMemo","Switch","element","node","isValidElement","elementProps","cloneElement","LifeCycle","prevProps","onMount","onUpdate","onUnmount","Redirect","_props$push","calcLocation","navigate","_calcLocation","_excluded","onMountFunc","onUpdateFunc","prevPath","data","Prompt","_props$when","when","release","onUnmountFunc","withRouter","Component","wrappedComponentRef","rest","ref","HashRouter","historyRef","BrowserRouter","isModifiedEvent","metaKey","altKey","ctrlKey","shiftKey","checkTarget","Link","onClick","other","linkClickEvent","preventDefault","defaultPrevented","button","isSamePath","linkProps","Inula","NavLink","className","activeClassName","Context","toLocation","isLinkActive","classNames","Boolean","page","otherProps","getIn","res","stateReader","storeType","isRouter","getRouter","router","getAction","getSearch","getHash","hConnect","reduxAdapter","connect","ConnectedRouterWithoutMemo","store","omitRouter","_stateReader","unsubscribe","subscribe","_getLocation","getState","pathnameInStore","searchInStore","hashInStore","stateInStore","_history$location","pathnameInHistory","searchInHistory","hashInHistory","stateInHistory","handleLocationChange","noInitialPop","_Fragment","childrenNode","getConnectedRouter","mapDispatchToProps","dispatch","ConnectedRouter","memo","ConnectedRouterWithContext","ReactReduxContext","Consumer","ConnectedHRouterWithContext","routerMiddleware","_","next","_action$payload","connectRouter","ConnectedHRouter"],"mappings":"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"}