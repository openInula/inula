{"version":3,"file":"connectRouter.js","sources":["../../../../node_modules/.pnpm/@babel+runtime@7.23.8/node_modules/@babel/runtime/helpers/esm/extends.js","../../src/connect-router/actions.ts","../../src/connect-router/reducer.ts","../../../../node_modules/.pnpm/@babel+runtime@7.23.8/node_modules/@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js","../../src/history/dom.ts","../../src/history/types.ts","../../src/history/utils.ts","../../../../node_modules/.pnpm/@babel+runtime@7.23.8/node_modules/@babel/runtime/helpers/esm/classCallCheck.js","../../../../node_modules/.pnpm/@babel+runtime@7.23.8/node_modules/@babel/runtime/helpers/esm/typeof.js","../../../../node_modules/.pnpm/@babel+runtime@7.23.8/node_modules/@babel/runtime/helpers/esm/toPrimitive.js","../../../../node_modules/.pnpm/@babel+runtime@7.23.8/node_modules/@babel/runtime/helpers/esm/toPropertyKey.js","../../../../node_modules/.pnpm/@babel+runtime@7.23.8/node_modules/@babel/runtime/helpers/esm/createClass.js","../../src/history/transitionManager.ts","../../src/history/waring.ts","../../src/history/baseHistory.ts","../../src/history/browerHistory.ts","../../src/history/hashHistory.ts","../../src/router/context.tsx","../../src/matcher/types.ts","../../src/matcher/utils.ts","../../src/matcher/lexer.ts","../../src/matcher/parser.ts","../../src/router/hooks.ts","../../src/router/Route.tsx","../../src/router/Router.tsx","../../src/router/Switch.tsx","../../src/router/lifeCycleHook.ts","../../src/router/Redirect.tsx","../../src/router/Prompt.tsx","../../src/router/withRouter.tsx","../../src/router/HashRouter.tsx","../../src/router/BrowserRouter.tsx","../../src/router/Link.tsx","../../src/router/NavLink.tsx","../../src/connect-router/reduxUtils.ts","../../src/connect-router/connectedRouter.tsx","../../src/connect-router/dispatch.ts","../../src/connect-router/index.ts","../../src/router/index2.ts"],"sourcesContent":["export default function _extends() {\n  _extends = Object.assign ? Object.assign.bind() : function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends.apply(this, arguments);\n}","import { Action, Path } from '../history/types';\r\n\r\ntype Location = Partial<Path>\r\n\r\n// 定义位置变化和history方法调用的Action type\r\nexport enum ActionName {\r\n  LOCATION_CHANGE = '$inula-router/LOCATION_CHANGE',\r\n  CALL_HISTORY_METHOD = '$inula-router/CALL_HISTORY_METHOD'\r\n}\r\n\r\n// 定义Action的两种数据类型\r\nexport type ActionMessage = {\r\n  type: ActionName.LOCATION_CHANGE\r\n  payload: {\r\n    location: Location,\r\n    action: Action\r\n    isFirstRendering: boolean\r\n  }\r\n} | {\r\n  type: ActionName.CALL_HISTORY_METHOD\r\n  payload: {\r\n    method: string,\r\n    args: any\r\n  }\r\n}\r\n\r\n\r\nexport const onLocationChanged = (location: Location, action: Action, isFirstRendering = false): ActionMessage => {\r\n  return {\r\n    type: ActionName.LOCATION_CHANGE,\r\n    payload: {\r\n      location,\r\n      action,\r\n      isFirstRendering,\r\n    },\r\n  };\r\n};\r\n\r\nconst updateLocation = (method: string): (...args: any) => ActionMessage => {\r\n  return (...args: any) => ({\r\n    type: ActionName.CALL_HISTORY_METHOD,\r\n    payload: {\r\n      method,\r\n      args,\r\n    },\r\n  });\r\n};\r\n\r\nexport const push = updateLocation('push');\r\nexport const replace = updateLocation('replace');\r\nexport const go = updateLocation('go');","import { ActionName } from './actions';\r\nimport { Action, History } from '../history/types';\r\nimport { Location } from '../router';\r\n\r\ntype LocationWithQuery = Partial<Location> & { query?: Record<string, any> };\r\n\r\n// 解析location对象，将其中的query参数解析并注入\r\nfunction injectQueryParams(location?: LocationWithQuery): LocationWithQuery {\r\n  if (location && location.query) {\r\n    return location;\r\n  }\r\n\r\n  const queryString = location && location.search;\r\n\r\n  if (!queryString) {\r\n    return {\r\n      ...location,\r\n      query: {},\r\n    };\r\n  }\r\n  const queryObject: Record<string, any> = {};\r\n\r\n  const params = new URLSearchParams(queryString);\r\n  params.forEach((value, key) => (queryObject[key] = value));\r\n\r\n  return {\r\n    ...location,\r\n    query: queryObject,\r\n  };\r\n}\r\n\r\ntype InitRouterState = {\r\n  location: LocationWithQuery;\r\n  action: Action;\r\n};\r\n\r\ntype Payload = {\r\n  type?: ActionName;\r\n  payload?: any;\r\n};\r\n\r\nexport function createConnectRouter() {\r\n  // 初始化redux State\r\n  return (history: History) => {\r\n    const initRouterState = {\r\n      location: injectQueryParams(history.location),\r\n      action: history.action,\r\n    };\r\n\r\n    // 定义connect-router对应的redux reducer函数\r\n    return (state: InitRouterState = initRouterState, { type, payload }: Payload = {}): any => {\r\n      if (type === ActionName.LOCATION_CHANGE) {\r\n        const { location, action, isFirstRendering } = payload;\r\n        if (isFirstRendering) {\r\n          return state;\r\n        }\r\n        return { ...state, location: injectQueryParams(location), action: action };\r\n      }\r\n      return state;\r\n    };\r\n  };\r\n}\r\n","export default function _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n  return target;\n}","export function isBrowser(): boolean {\r\n  return typeof window !== 'undefined' && window.document && typeof window.document.createElement === 'function';\r\n}\r\n\r\nexport function getDefaultConfirmation(message: string, callBack: (result: boolean) => void) {\r\n  callBack(window.confirm(message));\r\n}\r\n\r\n// 判断浏览器是否支持pushState方法，pushState是browserHistory实现的基础\r\nexport function isSupportHistory(): boolean {\r\n  return isBrowser() && window.history && 'pushState' in window.history;\r\n}\r\n\r\n// 判断浏览器是否支持PopState事件\r\nexport function isSupportsPopState(): boolean {\r\n  return window.navigator.userAgent.indexOf('Trident') === -1;\r\n}\r\n","export type BaseOption = {\r\n  basename?: string;\r\n  getUserConfirmation?: ConfirmationFunc;\r\n};\r\n\r\nexport interface HistoryProps<T = unknown> {\r\n  readonly action: Action;\r\n\r\n  readonly location: Location<T>;\r\n\r\n  length: number;\r\n}\r\n\r\nexport interface AgnosticHistory<T = unknown> extends HistoryProps<T> {\r\n  createHref(path: Partial<Path>): string;\r\n\r\n  push(to: To, state?: T): void;\r\n\r\n  replace(to: To, state?: T): void;\r\n\r\n  listen(listener: CommonListener<T>): () => void;\r\n\r\n  // add listener for listen pop action\r\n  addListener(listener: Listener<T>): () => void;\r\n\r\n  // cancel all pop listeners\r\n  destroy(): void;\r\n\r\n  block(prompt: Prompt<T>): () => void;\r\n\r\n  go(index: number): void;\r\n\r\n  goBack(): void;\r\n\r\n  goForward(): void;\r\n}\r\n\r\nexport type History<T = unknown> = Omit<AgnosticHistory<T>, 'addListener' | 'destroy'>;\r\n\r\nexport interface LocationHandler<T> {\r\n  locationHandler?: ((state?: Partial<HistoryState<T>>) => Location<T>) | null;\r\n  baseHandler?: (() => string) | null;\r\n}\r\n\r\nexport interface CreateLocationHandler<T> {\r\n  locationHandler?: ((basename: string) => (state?: Partial<HistoryState<T>>) => Location<T>) | null;\r\n  baseHandler?: ((basename: string) => () => string) | null;\r\n}\r\n\r\nexport enum Action {\r\n  pop = 'POP',\r\n  push = 'PUSH',\r\n  replace = 'REPLACE',\r\n}\r\n\r\nexport enum EventType {\r\n  PopState = 'popstate',\r\n  HashChange = 'hashchange',\r\n}\r\n\r\nexport enum PopDirection {\r\n  back = 'back',\r\n  forward = 'forward',\r\n  unknown = '',\r\n}\r\n\r\nexport type Path = {\r\n  pathname: string;\r\n\r\n  search: string;\r\n\r\n  hash: string;\r\n};\r\n\r\nexport type HistoryState<T> = {\r\n  state?: T;\r\n\r\n  key: string;\r\n};\r\n\r\nexport type DefaultStateType = unknown;\r\n\r\nexport type Location<T = unknown> = Path & HistoryState<T>;\r\n\r\nexport type To = string | Partial<Path>;\r\n\r\nexport interface CommonListener<T = unknown> {\r\n  (navigation: Navigation<T>): void;\r\n}\r\n\r\nexport interface ActionInfo {\r\n  type: Action;\r\n  direction: PopDirection;\r\n  delta: number;\r\n}\r\n\r\nexport interface PopListener {\r\n  (to: string, from: string, information: ActionInfo): void;\r\n}\r\n\r\nexport interface PopNavigation {\r\n  to: string;\r\n  from: string;\r\n  information: ActionInfo;\r\n}\r\n\r\nexport type Listener<S> =\r\n  | {\r\n      type: 'common';\r\n      listener: CommonListener<S>;\r\n    }\r\n  | {\r\n      type: 'pop';\r\n      listener: PopListener;\r\n    };\r\n\r\nexport interface Navigation<T = unknown> {\r\n  action: Action;\r\n\r\n  location: Location<T>;\r\n}\r\n\r\nexport type Prompt<S> = string | boolean | null | ((location: Location<S>, action: Action) => void);\r\n\r\nexport type CallBackFunc = (isJump: boolean) => void;\r\n\r\nexport type ConfirmationFunc = (message: string, callBack: CallBackFunc) => void;\r\n\r\nexport interface TManager<S> {\r\n  setPrompt(next: Prompt<S>): () => void;\r\n\r\n  confirmJumpTo(\r\n    location: Location<S>,\r\n    action: Action,\r\n    userConfirmationFunc: ConfirmationFunc,\r\n    callBack: CallBackFunc\r\n  ): void;\r\n}\r\n","import { Action, Location, Path, To } from './types';\r\n\r\nexport function createPath(path: Partial<Path>): string {\r\n  const { search, hash } = path;\r\n  let pathname = path.pathname || '/';\r\n  if (search && search !== '?') {\r\n    pathname += search.startsWith('?') ? search : '?' + search;\r\n  }\r\n  if (hash && hash !== '#') {\r\n    pathname += hash.startsWith('#') ? hash : '#' + hash;\r\n  }\r\n  return pathname;\r\n}\r\n\r\nexport function parsePath(url: string): Partial<Path> {\r\n  let pathname = url || '/';\r\n  const parsedPath: Partial<Path> = {\r\n    search: '',\r\n    hash: '',\r\n  };\r\n\r\n  const hashIdx = url.indexOf('#');\r\n  if (hashIdx > -1) {\r\n    const hash = url.substring(hashIdx);\r\n    parsedPath.hash = hash === '#' ? '' : hash;\r\n    pathname = pathname.substring(0, hashIdx);\r\n  }\r\n\r\n  const searchIdx = url.indexOf('?');\r\n  if (searchIdx > -1) {\r\n    const search = url.substring(searchIdx);\r\n    parsedPath.search = search === '?' ? '' : search;\r\n    pathname = pathname.substring(0, searchIdx);\r\n  }\r\n  parsedPath.pathname = pathname;\r\n  return parsedPath;\r\n}\r\n\r\nexport function createLocation<S>(current: string | Location, to: To, state?: S, key?: string): Readonly<Location<S>> {\r\n  const pathname = typeof current === 'string' ? current : current.pathname;\r\n  const urlObj = typeof to === 'string' ? parsePath(to) : to;\r\n  // 随机key长度取6\r\n  const getRandKey = genRandomKey(6);\r\n  const location = {\r\n    pathname: pathname,\r\n    search: '',\r\n    hash: '',\r\n    state: state,\r\n    key: typeof key === 'string' ? key : getRandKey(),\r\n    ...urlObj,\r\n  };\r\n  if (!location.pathname) {\r\n    location.pathname = pathname ? pathname : '/';\r\n  } else if (!location.pathname.startsWith('/')) {\r\n    location.pathname = parseRelativePath(location.pathname, pathname);\r\n  }\r\n  if (location.search && location.search[0] !== '?') {\r\n    location.search = '?' + location.search;\r\n  }\r\n  if (location.hash && location.hash[0] !== '#') {\r\n    location.hash = '#' + location.hash;\r\n  }\r\n  return location;\r\n}\r\n\r\nexport function isLocationEqual(p1: Partial<Path>, p2: Partial<Path>) {\r\n  return p1.pathname === p2.pathname && p1.search === p2.search && p1.hash === p2.hash;\r\n}\r\n\r\nexport function addHeadSlash(path: string): string {\r\n  if (path[0] === '/') {\r\n    return path;\r\n  }\r\n  return '/' + path;\r\n}\r\n\r\nexport function stripHeadSlash(path: string): string {\r\n  if (path[0] === '/') {\r\n    return path.substring(1);\r\n  }\r\n  return path;\r\n}\r\n\r\nexport function normalizeSlash(path: string): string {\r\n  const tempPath = addHeadSlash(path);\r\n  if (tempPath[tempPath.length - 1] === '/') {\r\n    return tempPath.substring(0, tempPath.length - 1);\r\n  }\r\n  return tempPath;\r\n}\r\n\r\nexport function hasBasename(path: string, prefix: string): boolean {\r\n  return (\r\n    path.toLowerCase().indexOf(prefix.toLowerCase()) === 0 && ['/', '?', '#', ''].includes(path.charAt(prefix.length))\r\n  );\r\n}\r\n\r\nexport function stripBasename(path: string, prefix: string): string {\r\n  return hasBasename(path, prefix) ? path.substring(prefix.length) : path;\r\n}\r\n\r\n// 使用随机生成的Key记录被访问过的URL，当Block被被触发时利用delta值跳转到之前的页面\r\nexport function createMemoryRecord<T, S>(initVal: S, fn: (arg: S) => T) {\r\n  let visitedRecord: T[] = [fn(initVal)];\r\n\r\n  function getDelta(to: S, from: S): number {\r\n    let toIdx = visitedRecord.lastIndexOf(fn(to));\r\n    if (toIdx === -1) {\r\n      toIdx = 0;\r\n    }\r\n    let fromIdx = visitedRecord.lastIndexOf(fn(from));\r\n    if (fromIdx === -1) {\r\n      fromIdx = 0;\r\n    }\r\n    return toIdx - fromIdx;\r\n  }\r\n\r\n  function addRecord(current: S, newRecord: S, action: Action) {\r\n    const curVal = fn(current);\r\n    const NewVal = fn(newRecord);\r\n    if (action === Action.push) {\r\n      const prevIdx = visitedRecord.lastIndexOf(curVal);\r\n      const newVisitedRecord = visitedRecord.slice(0, prevIdx + 1);\r\n      newVisitedRecord.push(NewVal);\r\n      visitedRecord = newVisitedRecord;\r\n    }\r\n    if (action === Action.replace) {\r\n      const prevIdx = visitedRecord.lastIndexOf(curVal);\r\n      if (prevIdx !== -1) {\r\n        visitedRecord[prevIdx] = NewVal;\r\n      }\r\n    }\r\n  }\r\n\r\n  return { getDelta, addRecord };\r\n}\r\n\r\nfunction genRandomKey(length: number): () => string {\r\n  const end = length + 2;\r\n  return () => {\r\n    return Math.random().toString(18).substring(2, end);\r\n  };\r\n}\r\n\r\nexport function parseRelativePath(to: string, from: string) {\r\n  if (to.startsWith('/')) {\r\n    return to;\r\n  }\r\n  const fromParts = from.split('/');\r\n  const toParts = to.split('/');\r\n  const lastToPart = toParts[toParts.length - 1];\r\n  if (lastToPart === '..' || lastToPart === '.') {\r\n    toParts.push('');\r\n  }\r\n  let index = fromParts.length - 1;\r\n  let toIndex = 0;\r\n  let urlPart: string;\r\n\r\n  while (toIndex < toParts.length) {\r\n    urlPart = toParts[toIndex];\r\n    if (urlPart === '.') {\r\n      continue;\r\n    }\r\n    if (urlPart === '..') {\r\n      if (index > 1) {\r\n        index--;\r\n      }\r\n      toIndex++;\r\n    } else {\r\n      break;\r\n    }\r\n  }\r\n  return fromParts.slice(0, index).join('/') + '/' + toParts.slice(toIndex).join('/');\r\n}\r\n","export default function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}","export default function _typeof(o) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) {\n    return typeof o;\n  } : function (o) {\n    return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o;\n  }, _typeof(o);\n}","import _typeof from \"./typeof.js\";\nexport default function toPrimitive(t, r) {\n  if (\"object\" != _typeof(t) || !t) return t;\n  var e = t[Symbol.toPrimitive];\n  if (void 0 !== e) {\n    var i = e.call(t, r || \"default\");\n    if (\"object\" != _typeof(i)) return i;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (\"string\" === r ? String : Number)(t);\n}","import _typeof from \"./typeof.js\";\nimport toPrimitive from \"./toPrimitive.js\";\nexport default function toPropertyKey(t) {\n  var i = toPrimitive(t, \"string\");\n  return \"symbol\" == _typeof(i) ? i : String(i);\n}","import toPropertyKey from \"./toPropertyKey.js\";\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, toPropertyKey(descriptor.key), descriptor);\n  }\n}\nexport default function _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  Object.defineProperty(Constructor, \"prototype\", {\n    writable: false\n  });\n  return Constructor;\n}","import type { Action, CallBackFunc, ConfirmationFunc, Location, Prompt, TManager } from './types';\r\n\r\nclass TransitionManager<S> implements TManager<S> {\r\n  private prompt: Prompt<S>;\r\n\r\n  constructor() {\r\n    this.prompt = null;\r\n  }\r\n\r\n  public setPrompt(prompt: Prompt<S>): () => void {\r\n    this.prompt = prompt;\r\n\r\n    // 清除Prompt\r\n    return () => {\r\n      if (this.prompt === prompt) {\r\n        this.prompt = null;\r\n      }\r\n    };\r\n  }\r\n\r\n  public confirmJumpTo(\r\n    location: Location<S>,\r\n    action: Action,\r\n    userConfirmationFunc: ConfirmationFunc,\r\n    callBack: CallBackFunc\r\n  ) {\r\n    if (this.prompt !== null) {\r\n      const result = typeof this.prompt === 'function' ? this.prompt(location, action) : this.prompt;\r\n      if (typeof result === 'string') {\r\n        typeof userConfirmationFunc === 'function' ? userConfirmationFunc(result, callBack) : callBack(true);\r\n      } else {\r\n        callBack(result !== false);\r\n      }\r\n    } else {\r\n      callBack(true);\r\n    }\r\n  }\r\n}\r\n\r\nexport default TransitionManager;\r\n","function warning(condition: any, message: string) {\r\n  if (condition) {\r\n    if (console && typeof console.warn === 'function') {\r\n      console.warn(message);\r\n    }\r\n  }\r\n}\r\n\r\nexport default warning;","import { Action, EventType, HistoryProps, Listener, Navigation, PopDirection, PopNavigation, Prompt } from './types';\r\nimport transitionManager from './transitionManager';\r\nimport { isSupportsPopState } from './dom';\r\nimport { createPath } from './utils';\r\n\r\ntype Trigger<S> =\r\n  | {\r\n      type: 'common';\r\n      trigger: (arg: Navigation<S>) => void;\r\n    }\r\n  | {\r\n      type: 'pop';\r\n      trigger: (arg: PopNavigation) => void;\r\n    };\r\n\r\n// 抽取BrowserHistory和HashHistory中相同的方法\r\nexport function getBaseHistory<S>(\r\n  type: 'browser' | 'hash' = 'browser',\r\n  transitionManager: transitionManager<S>,\r\n  popActionListener: (event: PopStateEvent | HashChangeEvent) => void\r\n) {\r\n  let listenerCount = 0;\r\n  const supportPopState = isSupportsPopState();\r\n  let listeners: Trigger<S>[] = [];\r\n  const unListeners: (() => void)[] = [];\r\n  const browserHistory = window.history;\r\n\r\n  // 标记是否暂停触发type为pop类型的listener\r\n  let pauseTrigger = false;\r\n\r\n  function go(step: number, triggerListener = true) {\r\n    if (triggerListener) {\r\n      pauseTrigger = true;\r\n    }\r\n    browserHistory.go(step);\r\n  }\r\n\r\n  function setupListener(count: number | null) {\r\n    if (count === null) {\r\n      listenerCount = 0;\r\n    } else {\r\n      listenerCount += count;\r\n    }\r\n    if (listenerCount === 1 && count === 1) {\r\n      if (type === 'browser' && supportPopState) {\r\n        addEventListener(EventType.PopState, popActionListener);\r\n      } else {\r\n        addEventListener(EventType.HashChange, popActionListener);\r\n      }\r\n    } else if (listenerCount === 0) {\r\n      if (type === 'browser' && supportPopState) {\r\n        removeEventListener(EventType.PopState, popActionListener);\r\n      } else {\r\n        removeEventListener(EventType.HashChange, popActionListener);\r\n      }\r\n    }\r\n  }\r\n\r\n  function addListener(listener: Listener<S>): () => void {\r\n    let isActive = true;\r\n    const wrapper = (args: Navigation<S> | PopNavigation) => {\r\n      if (isActive) {\r\n        if (listener.type === 'common' && 'action' in args) {\r\n          listener.listener(args);\r\n        } else if (listener.type === 'pop' && 'to' in args) {\r\n          listener.listener(args.to, args.from, args.information);\r\n        }\r\n      }\r\n    };\r\n    const trigger: Trigger<S> = { type: listener.type, trigger: wrapper };\r\n    listeners.push(trigger);\r\n    setupListener(1);\r\n\r\n    const cancelListener = () => {\r\n      isActive = false;\r\n      setupListener(-1);\r\n      listeners = listeners.filter(listener => listener !== trigger);\r\n    };\r\n\r\n    unListeners.push(cancelListener);\r\n    return cancelListener;\r\n  }\r\n\r\n  function destroy() {\r\n    for (const unListen of unListeners) {\r\n      unListen();\r\n    }\r\n    unListeners.length = 0;\r\n    setupListener(null);\r\n  }\r\n\r\n  let isBlocked = false;\r\n\r\n  function block(prompt: Prompt<S> = false): () => void {\r\n    const unblock = transitionManager.setPrompt(prompt);\r\n    if (!isBlocked) {\r\n      setupListener(1);\r\n      isBlocked = true;\r\n    }\r\n    return () => {\r\n      if (isBlocked) {\r\n        isBlocked = false;\r\n        setupListener(-1);\r\n      }\r\n      unblock();\r\n    };\r\n  }\r\n\r\n  function getUpdateStateFunc(historyProps: HistoryProps<S>) {\r\n    return function (nextState: Navigation<S> | undefined) {\r\n      const originPath = createPath(historyProps.location);\r\n      if (nextState) {\r\n        Object.assign(historyProps, nextState);\r\n      }\r\n      const delta = browserHistory.length - historyProps.length;\r\n      historyProps.length = browserHistory.length;\r\n      // 避免location引用相同时setState不触发\r\n      const location = Object.assign({}, historyProps.location);\r\n      const commonArgs = { location: location, action: historyProps.action };\r\n      const popArgs: PopNavigation = {\r\n        to: createPath(location),\r\n        from: originPath,\r\n        information: {\r\n          delta: delta,\r\n          direction: delta > 0 ? PopDirection.forward : PopDirection.back,\r\n          type: Action.pop,\r\n        },\r\n      };\r\n      for (let i = 0; i < listeners.length && !pauseTrigger; i++) {\r\n        const listener = listeners[i];\r\n        if (listener.type === 'common') {\r\n          listener.trigger(commonArgs);\r\n        } else if (listener.type === 'pop' && historyProps.action === Action.pop) {\r\n          // vue history listener only trigger when action is pop\r\n          listener.trigger(popArgs);\r\n        }\r\n      }\r\n      pauseTrigger = false;\r\n    };\r\n  }\r\n\r\n  return { go, addListener, block, destroy, getUpdateStateFunc };\r\n}\r\n","import { getDefaultConfirmation, isSupportHistory, isSupportsPopState } from './dom';\r\nimport {\r\n  Action,\r\n  AgnosticHistory,\r\n  BaseOption,\r\n  CommonListener,\r\n  DefaultStateType,\r\n  EventType,\r\n  History,\r\n  HistoryState,\r\n  Listener,\r\n  Location,\r\n  LocationHandler,\r\n  Path,\r\n  To,\r\n} from './types';\r\nimport { createLocation, createMemoryRecord, createPath, normalizeSlash, stripBasename } from './utils';\r\nimport TransitionManager from './transitionManager';\r\n\r\nimport warning from './waring';\r\nimport { getBaseHistory } from './baseHistory';\r\n\r\nexport type BrowserHistoryOption = {\r\n  /**\r\n   * forceRefresh为True时跳转时会强制刷新页面\r\n   */\r\n  forceRefresh?: boolean;\r\n} & BaseOption;\r\n\r\nexport function createBrowserHistory<S = DefaultStateType>(options: BrowserHistoryOption): History<S>;\r\n/**\r\n * @internal\r\n * @desc this override signature only for internal usage\r\n */\r\nexport function createBrowserHistory<S = DefaultStateType>(\r\n  options: LocationHandler<S> & BrowserHistoryOption\r\n): AgnosticHistory<S>;\r\nexport function createBrowserHistory<S = DefaultStateType>(\r\n  options: LocationHandler<S> & BrowserHistoryOption = {}\r\n): AgnosticHistory<S> {\r\n  const supportHistory = isSupportHistory();\r\n  const isSupportPopState = isSupportsPopState();\r\n  const browserHistory = window.history;\r\n  const { forceRefresh = false, getUserConfirmation = getDefaultConfirmation } = options;\r\n\r\n  const basename = options.basename ? normalizeSlash(options.basename) : '';\r\n\r\n  const initLocation = getLocation(getHistoryState());\r\n\r\n  const recordOperator = createMemoryRecord<string, Location<S>>(initLocation, l => l.key);\r\n\r\n  const transitionManager = new TransitionManager<S>();\r\n\r\n  const { go, addListener, block, destroy, getUpdateStateFunc } = getBaseHistory<S>(\r\n    'browser',\r\n    transitionManager,\r\n    handlePop\r\n  );\r\n\r\n  const listen = (listener: CommonListener<S>) => {\r\n    const trigger: Listener<S> = { type: 'common', listener: listener };\r\n    return addListener(trigger);\r\n  };\r\n\r\n  const history: AgnosticHistory<S> = {\r\n    action: Action.pop,\r\n    length: browserHistory.length,\r\n    location: initLocation,\r\n    go,\r\n    goBack: () => go(-1),\r\n    goForward: () => go(-1),\r\n    listen,\r\n    addListener,\r\n    block,\r\n    push,\r\n    replace,\r\n    destroy,\r\n    createHref,\r\n  };\r\n\r\n  const updateState = getUpdateStateFunc(history);\r\n\r\n  function getHistoryState() {\r\n    return supportHistory ? window.history.state : {};\r\n  }\r\n\r\n  function getLocation(historyState: Partial<HistoryState<S>>) {\r\n    const { search, hash } = window.location;\r\n    const { key, state } = historyState || {};\r\n    let pathname = window.location.pathname;\r\n    pathname = basename ? stripBasename(pathname, basename) : pathname;\r\n\r\n    return createLocation<S>('', { pathname, search, hash }, state, key);\r\n  }\r\n\r\n  // 拦截页面POP事件后，防止返回到的页面被重复拦截\r\n  let forceJump = false;\r\n\r\n  function handlePopState(location: Location<S>) {\r\n    if (forceJump) {\r\n      forceJump = false;\r\n      updateState(undefined);\r\n    } else {\r\n      const action = Action.pop;\r\n\r\n      const callback = (isJump: boolean) => {\r\n        if (isJump) {\r\n          // 执行跳转行为\r\n          updateState({ action: action, location: location });\r\n        } else {\r\n          revertPopState(location, history.location);\r\n        }\r\n      };\r\n\r\n      transitionManager.confirmJumpTo(location, action, getUserConfirmation, callback);\r\n    }\r\n  }\r\n\r\n  const isEventPopState = (event: Event): event is PopStateEvent => {\r\n    return event.type === EventType.PopState;\r\n  };\r\n\r\n  function handlePop(event: PopStateEvent | HashChangeEvent) {\r\n    const historyState = isSupportPopState && isEventPopState(event) ? event.state : getHistoryState();\r\n    const handler = options.locationHandler ? options.locationHandler : getLocation;\r\n    handlePopState(handler(historyState));\r\n  }\r\n\r\n  // 取消页面跳转并恢复到跳转前的页面\r\n  function revertPopState(from: Location<S>, to: Location<S>) {\r\n    const delta = recordOperator.getDelta(to, from);\r\n    if (delta !== 0) {\r\n      go(delta);\r\n      forceJump = true;\r\n    }\r\n  }\r\n\r\n  function createHref(path: Partial<Path>) {\r\n    return (options.baseHandler ? options.baseHandler() : basename) + createPath(path);\r\n  }\r\n\r\n  function push(to: To, state?: S) {\r\n    const action = Action.push;\r\n    const location = createLocation<S>(history.location, to, state, undefined);\r\n\r\n    transitionManager.confirmJumpTo(location, action, getUserConfirmation, isJump => {\r\n      if (!isJump) {\r\n        return;\r\n      }\r\n      const href = createHref(location);\r\n      const { key, state } = location;\r\n\r\n      if (supportHistory) {\r\n        if (forceRefresh) {\r\n          window.location.href = href;\r\n        } else {\r\n          browserHistory.pushState({ key: key, state: state }, '', href);\r\n          recordOperator.addRecord(history.location, location, action);\r\n          updateState({ action, location });\r\n        }\r\n      } else {\r\n        warning(state !== undefined, 'Browser history cannot push state in browsers that do not support HTML5 history');\r\n        window.location.href = href;\r\n      }\r\n    });\r\n  }\r\n\r\n  function replace(to: To, state?: S) {\r\n    const action = Action.replace;\r\n    const location = createLocation<S>(history.location, to, state, undefined);\r\n\r\n    transitionManager.confirmJumpTo(location, action, getUserConfirmation, isJump => {\r\n      if (!isJump) {\r\n        return;\r\n      }\r\n      const href = createHref(location);\r\n      const { key, state } = location;\r\n      if (supportHistory) {\r\n        if (forceRefresh) {\r\n          window.location.replace(href);\r\n        } else {\r\n          browserHistory.replaceState({ key: key, state: state }, '', href);\r\n          recordOperator.addRecord(history.location, location, action);\r\n          updateState({ action, location });\r\n        }\r\n      } else {\r\n        warning(state !== undefined, 'Browser history cannot push state in browsers that do not support HTML5 history');\r\n        window.location.replace(href);\r\n      }\r\n    });\r\n  }\r\n\r\n  return history;\r\n}\r\n","import { Action, AgnosticHistory, BaseOption, CommonListener, DefaultStateType, Listener, Location, To } from './types';\r\nimport {\r\n  addHeadSlash,\r\n  createLocation,\r\n  createMemoryRecord,\r\n  createPath,\r\n  isLocationEqual,\r\n  normalizeSlash,\r\n  stripBasename,\r\n  stripHeadSlash,\r\n} from './utils';\r\nimport { getDefaultConfirmation } from './dom';\r\nimport TransitionManager from './transitionManager';\r\n\r\nimport warning from './waring';\r\nimport { getBaseHistory } from './baseHistory';\r\n\r\nexport type urlHashType = 'slash' | 'noslash';\r\n\r\ntype HashHistoryOption = {\r\n  hashType?: urlHashType;\r\n} & BaseOption;\r\n\r\n// 获取#前的内容\r\nfunction stripHash(path: string): string {\r\n  const idx = path.indexOf('#');\r\n  return idx === -1 ? path : path.substring(0, idx);\r\n}\r\n\r\n// 获取#后的内容\r\nexport function getHashContent(path: string): string {\r\n  const idx = path.indexOf('#');\r\n  return idx === -1 ? '' : path.substring(idx + 1);\r\n}\r\n\r\nexport function createHashHistory<S = DefaultStateType>(option: HashHistoryOption = {}): AgnosticHistory<S> {\r\n  const browserHistory = window.history;\r\n  const { hashType = 'slash', getUserConfirmation = getDefaultConfirmation } = option;\r\n\r\n  const basename = option.basename ? normalizeSlash(option.basename) : '';\r\n\r\n  const pathDecoder = addHeadSlash;\r\n  const pathEncoder = hashType === 'slash' ? addHeadSlash : stripHeadSlash;\r\n\r\n  const startLocation = getHashContent(window.location.href);\r\n  const encodedLocation = pathEncoder(startLocation);\r\n  // 初始化hash格式不合法时会重定向\r\n  if (startLocation !== encodedLocation) {\r\n    window.location.replace(stripHash(window.location.href) + '#' + encodedLocation);\r\n  }\r\n\r\n  function getLocation() {\r\n    let hashPath = pathDecoder(getHashContent(window.location.hash));\r\n    if (basename) {\r\n      hashPath = stripBasename(hashPath, basename);\r\n    }\r\n\r\n    return createLocation<S>('', hashPath, undefined, 'default');\r\n  }\r\n\r\n  const initLocation = getLocation();\r\n\r\n  const memRecords = createMemoryRecord<string, Location<S>>(initLocation, createPath);\r\n\r\n  const transitionManager = new TransitionManager<S>();\r\n\r\n  function createHref(location: Location<S>) {\r\n    const tag = document.querySelector('base');\r\n    const base = tag && tag.getAttribute('href') ? stripHash(window.location.href) : '';\r\n    return base + '#' + pathEncoder(basename + createPath(location));\r\n  }\r\n\r\n  let forceNextPop = false;\r\n  let ignorePath: null | string = null;\r\n\r\n  const listen = (listener: CommonListener<S>) => {\r\n    const trigger: Listener<S> = { type: 'common', listener: listener };\r\n    return addListener(trigger);\r\n  };\r\n\r\n  const { go, addListener, block, destroy, getUpdateStateFunc } = getBaseHistory(\r\n    'hash',\r\n    transitionManager,\r\n    handleHashChange\r\n  );\r\n\r\n  const history: AgnosticHistory<S> = {\r\n    action: Action.pop,\r\n    length: browserHistory.length,\r\n    location: initLocation,\r\n    go,\r\n    goBack: () => go(-1),\r\n    goForward: () => go(1),\r\n    push,\r\n    replace,\r\n    listen,\r\n    addListener,\r\n    block,\r\n    destroy,\r\n    createHref,\r\n  };\r\n\r\n  const updateState = getUpdateStateFunc(history);\r\n\r\n  function push(to: To, state?: S) {\r\n    warning(state !== undefined, 'Hash history does not support state, it will be ignored');\r\n\r\n    const action = Action.push;\r\n    const location = createLocation<S>(history.location, to, state, '');\r\n\r\n    transitionManager.confirmJumpTo(location, action, getUserConfirmation, isJump => {\r\n      if (!isJump) {\r\n        return;\r\n      }\r\n      const path = createPath(location);\r\n      const encodedPath = pathEncoder(basename + path);\r\n      // 前后hash不一样才进行跳转\r\n      if (getHashContent(window.location.href) !== encodedPath) {\r\n        ignorePath = encodedPath;\r\n        window.location.hash = encodedPath;\r\n\r\n        memRecords.addRecord(history.location, location, action);\r\n\r\n        updateState({ action, location });\r\n      } else {\r\n        updateState(undefined);\r\n      }\r\n    });\r\n  }\r\n\r\n  function replace(to: To, state?: S) {\r\n    warning(state !== undefined, 'Hash history does not support state, it will be ignored');\r\n    const action = Action.replace;\r\n    const location = createLocation<S>(history.location, to, state, '');\r\n\r\n    transitionManager.confirmJumpTo(location, action, getUserConfirmation, isJump => {\r\n      if (!isJump) {\r\n        return;\r\n      }\r\n      const path = createPath(location);\r\n      const encodedPath = pathEncoder(basename + path);\r\n      if (getHashContent(window.location.href) !== encodedPath) {\r\n        ignorePath = path;\r\n        window.location.replace(stripHash(window.location.href) + '#' + encodedPath);\r\n      }\r\n      memRecords.addRecord(history.location, location, action);\r\n      updateState({ action, location });\r\n    });\r\n  }\r\n\r\n  function handleHashChange() {\r\n    const hashPath = getHashContent(window.location.href);\r\n    const encodedPath = pathEncoder(hashPath);\r\n    if (hashPath !== encodedPath) {\r\n      window.location.replace(stripHash(window.location.href) + '#' + encodedPath);\r\n    } else {\r\n      const location = getLocation();\r\n      const prevLocation = history.location;\r\n      if (!forceNextPop && isLocationEqual(location, prevLocation)) {\r\n        return;\r\n      }\r\n      if (ignorePath === createPath(location)) {\r\n        return;\r\n      }\r\n      ignorePath = null;\r\n      handlePopState(location);\r\n    }\r\n  }\r\n\r\n  function handlePopState(location: Location<S>) {\r\n    if (forceNextPop) {\r\n      forceNextPop = false;\r\n      updateState(undefined);\r\n    } else {\r\n      const action = Action.pop;\r\n\r\n      const callback = (isJump: boolean) => {\r\n        if (isJump) {\r\n          updateState({ action: action, location: location });\r\n        } else {\r\n          revertPopState(location);\r\n        }\r\n      };\r\n\r\n      transitionManager.confirmJumpTo(location, action, getUserConfirmation, callback);\r\n    }\r\n  }\r\n\r\n  // 在跳转行为被Block后，用History.go()跳转回之前的页面\r\n  function revertPopState(from: Location<S>) {\r\n    const to = history.location;\r\n    const delta = memRecords.getDelta(to, from);\r\n    if (delta !== 0) {\r\n      go(delta);\r\n      forceNextPop = true;\r\n    }\r\n  }\r\n\r\n  return history;\r\n}\r\n","import { createContext } from '@cloudsop/horizon';\r\nimport { History, Location } from './index';\r\nimport { Matched } from '../matcher/parser';\r\n\r\nfunction createNamedContext<T>(name: string, defaultValue: T) {\r\n  const context = createContext<T>(defaultValue);\r\n  context.displayName = name;\r\n  return context;\r\n}\r\n\r\nexport type RouterContextValue = {\r\n  history: History;\r\n  location: Location;\r\n  match: Matched | null;\r\n};\r\n\r\nconst RouterContext = createNamedContext<RouterContextValue>('Router', {} as any);\r\n\r\nexport default RouterContext;\r\n","/*\r\n * Copyright (c) 2020 Huawei Technologies Co.,Ltd.\r\n *\r\n * openInula is licensed under Mulan PSL v2.\r\n * You can use this software according to the terms and conditions of the Mulan PSL v2.\r\n * You may obtain a copy of Mulan PSL v2 at:\r\n *\r\n *          http://license.coscl.org.cn/MulanPSL2\r\n *\r\n * THIS SOFTWARE IS PROVIDED ON AN \"AS IS\" BASIS, WITHOUT WARRANTIES OF ANY KIND,\r\n * EITHER EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO NON-INFRINGEMENT,\r\n * MERCHANTABILITY OR FIT FOR A PARTICULAR PURPOSE.\r\n * See the Mulan PSL v2 for more details.\r\n */\r\n\r\nimport { Matched, Params } from './parser';\r\n\r\nexport type Token = {\r\n  type: TokenType;\r\n  value: string;\r\n};\r\n\r\nexport enum TokenType {\r\n  Delimiter = 'delimiter',\r\n  Static = 'static',\r\n  Param = 'param',\r\n  WildCard = 'wildcard',\r\n  LBracket = '(',\r\n  RBracket = ')',\r\n  Pattern = 'pattern',\r\n}\r\n\r\nexport interface Parser<P> {\r\n  regexp: RegExp;\r\n\r\n  keys: string[];\r\n\r\n  score: number[];\r\n\r\n  parse(url: string): Matched<P> | null;\r\n\r\n  compile(params: Params<P>): string;\r\n}\r\n\r\nexport type ParserOption = {\r\n  // 是否大小写敏感\r\n  caseSensitive?: boolean;\r\n  // 是否启用严格模式\r\n  strictMode?: boolean;\r\n  // 精准匹配 兼容 React-RouterV5\r\n  exact?: boolean;\r\n};\r\n\r\ntype ClearLeading<U extends string> = U extends `/${infer R}` ? ClearLeading<R> : U;\r\ntype ClearTailing<U extends string> = U extends `${infer L}/` ? ClearTailing<L> : U;\r\n\r\ntype ParseParam<Param extends string> = Param extends `:${infer R}`\r\n  ? {\r\n      [K in R]: string;\r\n    }\r\n  : {};\r\n\r\ntype MergeParams<OneParam extends Record<string, any>, OtherParam extends Record<string, any>> = {\r\n  readonly [Key in keyof OneParam | keyof OtherParam]?: string;\r\n};\r\n\r\ntype ParseURLString<Str extends string> = Str extends `${infer Param}/${infer Rest}`\r\n  ? MergeParams<ParseParam<Param>, ParseURLString<ClearLeading<Rest>>>\r\n  : ParseParam<Str>;\r\n\r\n// 解析URL中的动态参数，以实现TypeScript提示功能\r\nexport type GetURLParams<U extends string> = ParseURLString<ClearLeading<ClearTailing<U>>>;\r\n","/**\r\n * @description 将url中的//转换为/\r\n */\r\nexport function cleanPath(path: string): string {\r\n  return path.replace(/\\/+/g, '/');\r\n}\r\n\r\nexport function scoreCompare(score1: number[], score2: number[]): number {\r\n  const score1Length = score1.length;\r\n  const score2Length = score2.length;\r\n  const end = Math.min(score1Length, score2Length);\r\n  for (let i = 0; i < end; i++) {\r\n    const delta = score2[i] - score1[i];\r\n    if (delta !== 0) {\r\n      return delta;\r\n    }\r\n  }\r\n  if (score1Length === score2Length) {\r\n    return 0;\r\n  }\r\n  return score1Length > score2Length ? -1 : 1;\r\n}\r\n\r\n// 把正则表达式的特殊符号加两个反斜杠进行转义\r\nexport function escapeStr(str: string) {\r\n  return str.replace(/([.+*?=^!:${}()[\\]|/\\\\])/g, '\\\\$1');\r\n}\r\n","import { Token, TokenType } from './types';\r\nimport { cleanPath } from './utils';\r\n\r\nconst validChar = /[^/:()*?$^+]/;\r\n\r\n// 对Url模板进行词法解析，解析结果为Tokens\r\nexport function lexer(path: string): Token[] {\r\n  const tokens: Token[] = [];\r\n\r\n  if (!path) {\r\n    return tokens;\r\n  }\r\n\r\n  let urlPath = cleanPath(path);\r\n  if (urlPath !== '*' && !urlPath.startsWith('/')) {\r\n    throw new Error(`Url must start with \"/\".`);\r\n  }\r\n\r\n  const getLiteral = () => {\r\n    let name = '';\r\n    while (i < urlPath.length && validChar.test(urlPath[i])) {\r\n      name += urlPath[i];\r\n      skipChar(1);\r\n    }\r\n    return name;\r\n  };\r\n\r\n  const skipChar = (step: number) => {\r\n    i += step;\r\n  };\r\n\r\n  let i = 0;\r\n  while (i < urlPath.length) {\r\n    const curChar = urlPath[i];\r\n    const prevChar = urlPath[i - 1];\r\n\r\n    if (curChar === '/') {\r\n      tokens.push({ type: TokenType.Delimiter, value: urlPath[i] });\r\n      skipChar(1);\r\n      continue;\r\n    }\r\n    // dynamic params (/:a)\r\n    if (prevChar === '/' && curChar === ':') {\r\n      skipChar(1);\r\n      tokens.push({ type: TokenType.Param, value: getLiteral() });\r\n      continue;\r\n    }\r\n    // wildCard params (/:*)\r\n    if ((prevChar === '/' || prevChar === undefined) && curChar === '*') {\r\n      tokens.push({ type: TokenType.WildCard, value: urlPath[i] });\r\n      skipChar(1);\r\n      continue;\r\n    }\r\n    // static params\r\n    if (prevChar === '/' && validChar.test(curChar)) {\r\n      tokens.push({ type: TokenType.Static, value: getLiteral() });\r\n      continue;\r\n    }\r\n    if (curChar === '(') {\r\n      tokens.push({ type: TokenType.LBracket, value: '(' });\r\n      skipChar(1);\r\n      continue;\r\n    }\r\n    if (curChar === ')') {\r\n      tokens.push({ type: TokenType.RBracket, value: ')' });\r\n      skipChar(1);\r\n      continue;\r\n    }\r\n    if (['*', '?', '$', '^', '+'].includes(curChar)) {\r\n      tokens.push({ type: TokenType.Pattern, value: curChar });\r\n      skipChar(1);\r\n      continue;\r\n    }\r\n    if (validChar.test(curChar)) {\r\n      tokens.push({ type: TokenType.Pattern, value: getLiteral() });\r\n      continue;\r\n    }\r\n    // 跳过非法字符\r\n    skipChar(1);\r\n  }\r\n\r\n  return tokens;\r\n}\r\n","/*\r\n * Copyright (c) 2020 Huawei Technologies Co.,Ltd.\r\n *\r\n * openInula is licensed under Mulan PSL v2.\r\n * You can use this software according to the terms and conditions of the Mulan PSL v2.\r\n * You may obtain a copy of Mulan PSL v2 at:\r\n *\r\n *          http://license.coscl.org.cn/MulanPSL2\r\n *\r\n * THIS SOFTWARE IS PROVIDED ON AN \"AS IS\" BASIS, WITHOUT WARRANTIES OF ANY KIND,\r\n * EITHER EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO NON-INFRINGEMENT,\r\n * MERCHANTABILITY OR FIT FOR A PARTICULAR PURPOSE.\r\n * See the Mulan PSL v2 for more details.\r\n */\r\n\r\nimport { GetURLParams, Parser, ParserOption, TokenType } from './types';\r\nimport { lexer } from './lexer';\r\nimport { escapeStr, scoreCompare } from './utils';\r\n\r\n// 不同类型参数的匹配得分\r\nenum MatchScore {\r\n  // 固定参数\r\n  static = 10,\r\n  // 动态参数\r\n  param = 6,\r\n  // 通配符参数\r\n  wildcard = 3,\r\n  placeholder = -1,\r\n}\r\n\r\nexport type Params<P> = { [K in keyof P]?: P[K] };\r\n\r\n// 兼容 react v5 matched类型\r\nexport type Matched<P = any> = {\r\n  score: number[];\r\n  params: Params<P>;\r\n  path: string;\r\n  url: string;\r\n  isExact: boolean;\r\n};\r\n\r\nconst defaultOption: Required<ParserOption> = {\r\n  // url匹配时是否大小写敏感\r\n  caseSensitive: false,\r\n  // 是否严格匹配url结尾的/\r\n  strictMode: false,\r\n  // 是否完全精确匹配\r\n  exact: false,\r\n};\r\n// 正则表达式中需要转义的字符\r\nconst REGEX_CHARS_RE = /[.+*?^${}()[\\]/\\\\]/g;\r\n// 用于匹配两个//中的的值\r\nconst BASE_PARAM_PATTERN = '[^/]+';\r\n\r\nconst DefaultDelimiter = '/#?';\r\n\r\n/**\r\n * URL匹配整体流程\r\n * 1.词法解析，将URL模板解析为Token\r\n * 2.使用Token生成正则表达式\r\n * 3.利用正则表达式解析URL中参数或填充URL模板\r\n */\r\nexport function createPathParser<Str extends string>(pathname: Str, option?: ParserOption): Parser<GetURLParams<Str>>;\r\nexport function createPathParser<P = unknown>(pathname: string, option?: ParserOption): Parser<P>;\r\nexport function createPathParser<P = unknown>(pathname: string, option: ParserOption = defaultOption): Parser<P> {\r\n  const {\r\n    caseSensitive = defaultOption.caseSensitive,\r\n    strictMode = defaultOption.strictMode,\r\n    exact = defaultOption.exact,\r\n  } = option;\r\n\r\n  let pattern = '^';\r\n  const keys: string[] = [];\r\n  const scores: number[] = [];\r\n\r\n  const tokens = lexer(pathname);\r\n  const onlyHasWildCard = tokens.length === 1 && tokens[0].type === TokenType.WildCard;\r\n  const tokenCount = tokens.length;\r\n  const lastToken = tokens[tokenCount - 1];\r\n  let asteriskCount = 0;\r\n\r\n  /**\r\n   * 用于支持URL中的可选参数/:parma?\r\n   * @description 向前扫描到下一个分隔符/，检查其中是否有?\r\n   * @param currentIdx\r\n   */\r\n  const lookToNextDelimiter = (currentIdx: number): boolean => {\r\n    let hasOptionalParam = false;\r\n    while (currentIdx < tokens.length && tokens[currentIdx].type !== TokenType.Delimiter) {\r\n      if (tokens[currentIdx].value === '?' || tokens[currentIdx].value === '*') {\r\n        hasOptionalParam = true;\r\n      }\r\n      currentIdx++;\r\n    }\r\n    return hasOptionalParam;\r\n  };\r\n  for (let tokenIdx = 0; tokenIdx < tokenCount; tokenIdx++) {\r\n    const token = tokens[tokenIdx];\r\n    const nextToken = tokens[tokenIdx + 1];\r\n    switch (token.type) {\r\n      case TokenType.Delimiter: {\r\n        // 该分隔符后有可选参数则该分割符在匹配时是可选的\r\n        const hasOptional = lookToNextDelimiter(tokenIdx + 1);\r\n        // 该分隔符为最后一个且strictMode===false时，该分割符在匹配时是可选的\r\n        const isSlashOptional = nextToken === undefined && !strictMode;\r\n        pattern += `/${hasOptional || isSlashOptional ? '?' : ''}`;\r\n        break;\r\n      }\r\n      case TokenType.Static:\r\n        pattern += token.value.replace(REGEX_CHARS_RE, '\\\\$&');\r\n        if (nextToken && nextToken.type === TokenType.Pattern) {\r\n          pattern += `(.${nextToken.value})`;\r\n          keys.push(String(asteriskCount));\r\n          asteriskCount++;\r\n        }\r\n        scores.push(MatchScore.static);\r\n        break;\r\n      case TokenType.Param: {\r\n        // 动态参数支持形如/:param、/:param*、/:param?、/:param(\\\\d+)的形式\r\n        let paramRegexp = '';\r\n        if (nextToken) {\r\n          switch (nextToken.type) {\r\n            case TokenType.LBracket:\r\n              // 跳过当前Token和左括号\r\n              tokenIdx += 2;\r\n              while (tokens[tokenIdx].type !== TokenType.RBracket) {\r\n                paramRegexp += tokens[tokenIdx].value;\r\n                tokenIdx++;\r\n              }\r\n              paramRegexp = `(${paramRegexp})`;\r\n              break;\r\n            case TokenType.Pattern:\r\n              tokenIdx++;\r\n              paramRegexp += `(${nextToken.value === '*' ? '.*' : BASE_PARAM_PATTERN})${nextToken.value}`;\r\n              break;\r\n          }\r\n        }\r\n        pattern += paramRegexp ? `(?:${paramRegexp})` : `(${BASE_PARAM_PATTERN})`;\r\n        keys.push(token.value);\r\n        scores.push(MatchScore.param);\r\n        break;\r\n      }\r\n      case TokenType.WildCard:\r\n        keys.push(token.value);\r\n        pattern += `((?:${BASE_PARAM_PATTERN})${onlyHasWildCard ? '?' : ''}(?:/(?:${BASE_PARAM_PATTERN}))*)`;\r\n        scores.push(onlyHasWildCard ? MatchScore.wildcard : MatchScore.placeholder);\r\n        break;\r\n    }\r\n  }\r\n  const isWildCard = lastToken.type === TokenType.WildCard;\r\n\r\n  if (!isWildCard && !exact) {\r\n    if (!strictMode) {\r\n      pattern += `(?:[${escapeStr(DefaultDelimiter)}](?=$))?`;\r\n    }\r\n    if (lastToken.type !== TokenType.Delimiter) {\r\n      pattern += `(?=[${escapeStr(DefaultDelimiter)}]|$)`;\r\n    }\r\n  } else {\r\n    pattern += strictMode ? '$' : `[${escapeStr(DefaultDelimiter)}]?$`;\r\n  }\r\n\r\n  const flag = caseSensitive ? '' : 'i';\r\n  const regexp = new RegExp(pattern, flag);\r\n\r\n  /**\r\n   * @description 根据给定Pattern解析path\r\n   */\r\n  function parse(path: string): Matched<P> | null {\r\n    const reMatch = path.match(regexp);\r\n\r\n    if (!reMatch) {\r\n      return null;\r\n    }\r\n    const matchedPath = reMatch[0];\r\n    const params: Params<P> = {};\r\n    const parseScore: number[] = Array.from(scores);\r\n    for (let i = 1; i < reMatch.length; i++) {\r\n      const param = reMatch[i];\r\n      const key = keys[i - 1];\r\n      if (key === '*' && param) {\r\n        const value = param.split('/');\r\n        if (!Array.isArray(params['*'])) {\r\n          params['*'] = value;\r\n        } else {\r\n          params['*'].push(...value);\r\n        }\r\n        // 完成通配符参数解析后将placeholder替换为wildcard参数的分值\r\n        parseScore.splice(\r\n          scores.indexOf(MatchScore.placeholder),\r\n          1,\r\n          ...new Array(value.length).fill(MatchScore.wildcard)\r\n        );\r\n      } else {\r\n        params[key] = param ? param : undefined;\r\n      }\r\n    }\r\n\r\n    const isExact = path === matchedPath;\r\n    const url = path === '/' && matchedPath === '' ? '/' : matchedPath;\r\n    return { isExact: isExact, path: pathname, url: url, score: parseScore, params: params };\r\n  }\r\n\r\n  /**\r\n   * @description 使用给定参数填充pattern，得到目标URL\r\n   */\r\n  function compile(params: Params<P>): string {\r\n    let path = '';\r\n    for (const token of tokens) {\r\n      switch (token.type) {\r\n        case TokenType.Static:\r\n          path += token.value;\r\n          break;\r\n        case TokenType.Param:\r\n          if (!params[token.value]) {\r\n            throw new Error('Param is invalid.');\r\n          }\r\n          path += params[token.value];\r\n          break;\r\n        case TokenType.WildCard: {\r\n          const wildCard = params['*'];\r\n          if (wildCard instanceof Array) {\r\n            path += wildCard.join('/');\r\n          } else {\r\n            path += wildCard;\r\n          }\r\n          break;\r\n        }\r\n        case TokenType.Delimiter:\r\n          path += token.value;\r\n          break;\r\n      }\r\n    }\r\n    return path;\r\n  }\r\n\r\n  return {\r\n    regexp: regexp,\r\n    keys: keys,\r\n    score: scores,\r\n    compile,\r\n    parse,\r\n  };\r\n}\r\n\r\n/**\r\n * @description 依次使用pathname与pattern进行匹配，根据匹配分数取得分数最高结果\r\n */\r\nexport function matchPath<P = any>(\r\n  pathname: string,\r\n  pattern: string | string[],\r\n  option?: ParserOption\r\n): Matched<P> | null {\r\n  const patterns = Array.isArray(pattern) ? [...pattern] : [pattern];\r\n  const matchedResults: Matched<P>[] = [];\r\n  for (const item of patterns) {\r\n    const parser = createPathParser(item, option);\r\n    const matched = parser.parse(pathname);\r\n    if (matched) {\r\n      matchedResults.push(matched);\r\n    }\r\n  }\r\n  return !matchedResults.length ? null : matchedResults.sort((a, b) => scoreCompare(a.score, b.score))[0];\r\n}\r\n\r\nexport function generatePath<P = any>(path: string, params: Params<P>) {\r\n  const parser = createPathParser(path);\r\n  return parser.compile(params);\r\n}\r\n","import { useContext } from '@cloudsop/horizon';\r\nimport RouterContext from './context';\r\nimport { Matched, matchPath, Params } from '../matcher/parser';\r\nimport { History } from '../history/types';\r\nimport { Location } from './index';\r\n\r\nfunction useHistory<S>(): History<S>;\r\nfunction useHistory() {\r\n  return useContext(RouterContext).history;\r\n}\r\n\r\nfunction useLocation<S>(): Location<S>;\r\nfunction useLocation() {\r\n  return useContext(RouterContext).location;\r\n}\r\n\r\nfunction useParams<P>(): Params<P> | {};\r\nfunction useParams() {\r\n  const match = useContext(RouterContext).match;\r\n  return match ? match.params : {};\r\n}\r\n\r\nfunction useRouteMatch<P>(path?: string): Matched<P> | null;\r\nfunction useRouteMatch(path?: string) {\r\n  const pathname = useLocation().pathname;\r\n  const match = useContext(RouterContext).match;\r\n  if (path) {\r\n    return matchPath(pathname, path);\r\n  }\r\n  return match;\r\n}\r\n\r\nexport { useHistory, useLocation, useParams, useRouteMatch };\r\n","import Inula from '@cloudsop/horizon';\r\nimport { History, Location } from './index';\r\nimport { type Matched, matchPath } from '../matcher/parser';\r\nimport { useContext, Children, createElement, InulaNode, ComponentType } from '@cloudsop/horizon';\r\nimport RouterContext from './context';\r\nimport type { GetURLParams } from '../matcher/types';\r\n\r\nexport type RouteComponentProps<P extends Record<string, any> = {}, S = unknown> = RouteChildrenProps<P, S>;\r\n\r\nexport type RouteChildrenProps<P extends Record<string, any> = {}, S = unknown> = {\r\n  history: History<S>;\r\n  location: Location<S>;\r\n  match: Matched<P> | null;\r\n};\r\n\r\nexport type RouteProps<P extends Record<string, any> = {}, Path extends string = string> = {\r\n  location?: Location;\r\n  component?: ComponentType<RouteComponentProps<P>> | ComponentType<any> | undefined;\r\n  children?: ((props: RouteChildrenProps<P>) => InulaNode) | InulaNode;\r\n  render?: (props: RouteComponentProps<P>) => InulaNode;\r\n  path?: Path | Path[];\r\n  exact?: boolean;\r\n  sensitive?: boolean;\r\n  strict?: boolean;\r\n  computed?: Matched<P>;\r\n};\r\n\r\nfunction Route<Path extends string, P extends Record<string, any> = GetURLParams<Path>>(props: RouteProps<P, Path>) {\r\n  const context = useContext(RouterContext);\r\n\r\n  const { computed, location, path, component, render, strict, sensitive, exact } = props;\r\n  let { children } = props;\r\n  let match: Matched<P> | null;\r\n\r\n  const routeLocation = location || context.location;\r\n  if (computed) {\r\n    match = computed;\r\n  } else if (path) {\r\n    match = matchPath<P>(routeLocation.pathname, path, {\r\n      strictMode: strict,\r\n      caseSensitive: sensitive,\r\n      exact: exact,\r\n    });\r\n  } else {\r\n    match = context.match;\r\n  }\r\n  const newProps = { ...context, location: routeLocation, match: match };\r\n\r\n  if (Array.isArray(children) && Children.count(children) === 0) {\r\n    children = null;\r\n  }\r\n\r\n  /**\r\n   * 按顺序获取需要渲染的组件\r\n   * 1.children\r\n   * 2.component\r\n   * 3.render\r\n   * 都没有匹配到返回Null\r\n   */\r\n  const getChildren = (): InulaNode | null => {\r\n    // 如果 match 存在\r\n    if (newProps.match) {\r\n      if (children) {\r\n        if (typeof children === 'function') {\r\n          return children(newProps);\r\n        }\r\n        return children;\r\n      }\r\n\r\n      if (component) {\r\n        return createElement(component, newProps);\r\n      } else if (render) {\r\n        return render(newProps);\r\n      } else {\r\n        return null;\r\n      }\r\n    } else {\r\n      // match为null\r\n      if (typeof children === 'function') {\r\n        return children(newProps);\r\n      }\r\n      return null;\r\n    }\r\n  };\r\n\r\n  return <RouterContext.Provider value={newProps}>{getChildren()}</RouterContext.Provider>;\r\n}\r\n\r\nexport default Route;\r\n","import Inula from '@cloudsop/horizon';\r\nimport { useLayoutEffect, useMemo, useRef, useState, InulaNode } from '@cloudsop/horizon';\r\n\r\nimport { History, Location } from '../history/types';\r\n\r\nimport RouterContext, { RouterContextValue } from './context';\r\n\r\nexport type RouterProps = {\r\n  history: History;\r\n  children?: InulaNode;\r\n};\r\n\r\nfunction Router<P extends RouterProps>(props: P) {\r\n  const { history, children = null } = props;\r\n  const [location, setLocation] = useState(props.history.location);\r\n  const pendingLocation = useRef<Location | null>(null);\r\n  const unListen = useRef<null | (() => void)>(null);\r\n  const isMount = useRef<boolean>(false);\r\n\r\n  // 在Router加载时就监听history地址变化，以保证在始渲染时重定向能正确触发\r\n  if (unListen.current === null)\r\n    unListen.current = history.listen(arg => {\r\n      pendingLocation.current = arg.location;\r\n    });\r\n\r\n  // 模拟componentDidMount和componentWillUnmount\r\n  useLayoutEffect(() => {\r\n    isMount.current = true;\r\n    if (unListen.current) {\r\n      unListen.current();\r\n    }\r\n    // 监听history中的位置变化\r\n    unListen.current = history.listen(arg => {\r\n      if (isMount.current) {\r\n        setLocation(arg.location);\r\n      }\r\n    });\r\n\r\n    if (pendingLocation.current) {\r\n      setLocation(pendingLocation.current);\r\n    }\r\n\r\n    return () => {\r\n      if (unListen.current) {\r\n        isMount.current = false;\r\n        unListen.current();\r\n        unListen.current = null;\r\n        pendingLocation.current = null;\r\n      }\r\n    };\r\n  }, []);\r\n\r\n  const initContextValue: RouterContextValue = useMemo(\r\n    () => ({\r\n      history: history,\r\n      location: location,\r\n      match: { isExact: location.pathname === '/', params: {}, path: '/', score: [], url: '/' },\r\n    }),\r\n    [location],\r\n  );\r\n\r\n  return <RouterContext.Provider value={initContextValue} children={children} />;\r\n}\r\n\r\nexport default Router;\r\n","import Inula from '@cloudsop/horizon';\r\nimport { useContext, Children, isValidElement, cloneElement, InulaNode, InulaElement } from '@cloudsop/horizon';\r\n\r\nimport { Location } from './index';\r\nimport RouterContext from './context';\r\nimport { Matched, matchPath } from '../matcher/parser';\r\nimport type { RouteProps } from './Route';\r\nimport type { RedirectProps } from './Redirect';\r\n\r\nexport type SwitchProps = {\r\n  location?: Location;\r\n  children?: InulaNode;\r\n};\r\n\r\ntype MergeType<T1, T2> = { [K in keyof (T1 & T2)]: K extends keyof T1 ? T1[K] : K extends keyof T2 ? T2[K] : never };\r\n\r\nfunction Switch<P extends SwitchProps>(props: P): InulaElement | null {\r\n  const context = useContext(RouterContext);\r\n  const location = props.location || context.location;\r\n\r\n  let element: InulaElement | null = null;\r\n  let match: Matched | null = null;\r\n\r\n  // 使用forEach不会给React.ReactNode增加key属性,防止重新渲染\r\n  Children.forEach(props.children, node => {\r\n    if (match === null && isValidElement(node)) {\r\n      element = node;\r\n\r\n      const elementProps: MergeType<RouteProps, RedirectProps> = node.props;\r\n      const target = elementProps.path || elementProps.from;\r\n\r\n      // 更新匹配状态，一旦匹配到停止遍历\r\n      if (target) {\r\n        match = matchPath(location.pathname, target, {\r\n          strictMode: elementProps.strict,\r\n          caseSensitive: elementProps.sensitive,\r\n          exact: elementProps.exact,\r\n        });\r\n      } else {\r\n        match = context.match;\r\n      }\r\n    }\r\n  });\r\n\r\n  if (match && element) {\r\n    // 使用cloneElement复制已有组件并更新其Props\r\n    return cloneElement(element, { location: location, computed: match });\r\n  }\r\n  return null;\r\n}\r\n\r\nexport default Switch;\r\n","import { useLayoutEffect, useRef } from '@cloudsop/horizon';\r\n\r\nexport type LifeCycleProps = {\r\n  onMount?: () => void;\r\n  onUpdate?: (prevProps?: LifeCycleProps) => void;\r\n  onUnmount?: () => void;\r\n  data?: any;\r\n};\r\n\r\nexport function LifeCycle(props: LifeCycleProps) {\r\n  // 使用ref保存上一次的props，防止重新渲染\r\n  const prevProps = useRef<LifeCycleProps | null>(null);\r\n  const isMount = useRef(false);\r\n\r\n  const { onMount, onUpdate, onUnmount } = props;\r\n\r\n  useLayoutEffect(() => {\r\n    // 首次挂载 模拟componentDidMount\r\n    if (!isMount.current) {\r\n      isMount.current = true;\r\n      if (onMount) {\r\n        onMount();\r\n      }\r\n    } else {\r\n      // 不是首次渲染 模拟componentDidUpdate\r\n      if (onUpdate) {\r\n        prevProps.current ? onUpdate(prevProps.current) : onUpdate();\r\n      }\r\n    }\r\n    prevProps.current = props;\r\n  });\r\n\r\n  // 模拟componentWillUnmount\r\n  useLayoutEffect(() => {\r\n    return () => {\r\n      if (onUnmount) {\r\n        onUnmount();\r\n      }\r\n    };\r\n  }, []);\r\n\r\n  return null;\r\n}\r\n","import Inula from '@cloudsop/horizon';\r\nimport { useContext } from '@cloudsop/horizon';\r\nimport RouterContext from './context';\r\nimport { LifeCycle, LifeCycleProps } from './lifeCycleHook';\r\nimport { Matched, createPathParser } from '../matcher/parser';\r\nimport { addHeadSlash, isLocationEqual, parsePath } from '../history/utils';\r\nimport { Location } from './index';\r\n\r\nexport type RedirectProps = {\r\n  to: string | Partial<Location>;\r\n  push?: boolean;\r\n  path?: string;\r\n  from?: string;\r\n  exact?: boolean;\r\n  strict?: boolean;\r\n\r\n  // 由Switch计算得到\r\n  readonly computed?: Matched | null;\r\n};\r\n\r\nfunction Redirect<P extends RedirectProps>(props: P) {\r\n  const { to, push = false, computed } = props;\r\n\r\n  const context = useContext(RouterContext);\r\n  const { history } = context;\r\n\r\n  const calcLocation = (): Partial<Location> => {\r\n    if (computed) {\r\n      if (typeof to === 'string') {\r\n        const parser = createPathParser(to);\r\n        const target = parser.compile(computed.params);\r\n        return parsePath(target);\r\n      } else {\r\n        const pathname = to.pathname ? addHeadSlash(to.pathname) : '/';\r\n        const parser = createPathParser(pathname);\r\n        const target = parser.compile(computed.params);\r\n        return { ...to, pathname: target };\r\n      }\r\n    }\r\n    return typeof to === 'string' ? parsePath(to) : to;\r\n  };\r\n\r\n  const navigate = push ? history.push : history.replace;\r\n  const { state, ...path } = calcLocation();\r\n\r\n  const onMountFunc = () => {\r\n    navigate(path, state);\r\n  };\r\n\r\n  const onUpdateFunc = (prevProps?: LifeCycleProps) => {\r\n    // 如果当前页面与重定向前页面不一致，执行跳转\r\n    const prevPath = prevProps?.data as Location;\r\n    if (!isLocationEqual(prevPath, path)) {\r\n      navigate(path, state);\r\n    }\r\n  };\r\n\r\n  return <LifeCycle onMount={onMountFunc} onUpdate={onUpdateFunc} data={path} />;\r\n}\r\n\r\nexport default Redirect;\r\n","import Inula, { useRef } from '@cloudsop/horizon';\r\nimport { useContext } from '@cloudsop/horizon';\r\nimport { LifeCycle, LifeCycleProps } from './lifeCycleHook';\r\nimport { Location } from './index';\r\nimport { Action } from '../history/types';\r\nimport RouterContext from './context';\r\n\r\ntype PromptProps = {\r\n  message?: string | ((location: Partial<Location>, action: Action) => string | boolean);\r\n  when?: boolean | ((location: Partial<Location>) => boolean);\r\n};\r\n\r\nfunction Prompt<P extends PromptProps>(props: P) {\r\n  const context = useContext(RouterContext);\r\n\r\n  const { message, when = true } = props;\r\n\r\n  if ((typeof when === 'function' && when(context.location) === false) || !when) {\r\n    return null;\r\n  }\r\n\r\n  const navigate = context.history.block;\r\n\r\n  const release = useRef<(() => void) | null>(null);\r\n\r\n  const onMountFunc = () => {\r\n    release.current = message ? navigate(message) : null;\r\n  };\r\n\r\n  const onUpdateFunc = (prevProps?: LifeCycleProps) => {\r\n    if (prevProps && prevProps.data !== message) {\r\n      if (release.current) {\r\n        release.current();\r\n      }\r\n      release.current = message ? navigate(message) : null;\r\n    }\r\n  };\r\n\r\n  const onUnmountFunc = () => {\r\n    if (release.current) {\r\n      release.current();\r\n    }\r\n    release.current = null;\r\n  };\r\n\r\n  return <LifeCycle onMount={onMountFunc} onUpdate={onUpdateFunc} onUnmount={onUnmountFunc} data={message} />;\r\n}\r\n\r\nexport default Prompt;\r\n","import Inula from '@cloudsop/horizon';\r\nimport { useContext, ComponentType } from '@cloudsop/horizon';\r\nimport RouterContext from './context';\r\n\r\nfunction withRouter<C extends ComponentType>(Component: C) {\r\n  return function (props: any) {\r\n    const { wrappedComponentRef, ...rest } = props;\r\n    const context = useContext(RouterContext);\r\n\r\n    return <Component {...rest} {...context} ref={wrappedComponentRef} />;\r\n  };\r\n}\r\n\r\nexport default withRouter;\r\n","import Inula from '@cloudsop/horizon';\r\nimport { useRef } from '@cloudsop/horizon';\r\nimport { History } from '../history/types';\r\nimport { BaseRouterProps } from './BrowserRouter';\r\nimport { createHashHistory, urlHashType } from '../history/hashHistory';\r\nimport Router from './Router';\r\n\r\nexport type HashRouterProps = BaseRouterProps & {\r\n  hashType: urlHashType;\r\n};\r\n\r\nfunction HashRouter<P extends Partial<HashRouterProps>>(props: P) {\r\n  let historyRef = useRef<History>();\r\n  if (historyRef.current === null || historyRef.current === undefined) {\r\n    historyRef.current = createHashHistory({\r\n      basename: props.basename,\r\n      getUserConfirmation: props.getUserConfirmation,\r\n      hashType: props.hashType,\r\n    });\r\n  }\r\n\r\n  return <Router history={historyRef.current}>{props.children}</Router>;\r\n}\r\n\r\nexport default HashRouter;","import Inula from '@cloudsop/horizon';\r\nimport { useRef, InulaNode } from '@cloudsop/horizon';\r\nimport Router from './Router';\r\nimport { createBrowserHistory } from '../history/browerHistory';\r\nimport { ConfirmationFunc, History } from '../history/types';\r\n\r\nexport type BaseRouterProps = {\r\n  basename: string;\r\n  getUserConfirmation: ConfirmationFunc;\r\n  children?: InulaNode;\r\n};\r\n\r\nexport type BrowserRouterProps = BaseRouterProps & {\r\n  forceRefresh: boolean;\r\n};\r\n\r\nfunction BrowserRouter<P extends Partial<BrowserRouterProps>>(props: P) {\r\n  // 使用Ref持有History对象，防止重复渲染\r\n  let historyRef = useRef<History>();\r\n\r\n  if (historyRef.current === null || historyRef.current === undefined) {\r\n    historyRef.current = createBrowserHistory({\r\n      basename: props.basename,\r\n      forceRefresh: props.forceRefresh,\r\n      getUserConfirmation: props.getUserConfirmation,\r\n    });\r\n  }\r\n\r\n  return <Router history={historyRef.current}>{props.children}</Router>;\r\n}\r\n\r\nexport default BrowserRouter;","import Inula from '@cloudsop/horizon';\r\nimport { useContext, MouseEvent, ComponentType, Ref } from '@cloudsop/horizon';\r\nimport RouterContext from './context';\r\nimport { Location } from './index';\r\nimport { createPath, parsePath } from '../history/utils';\r\nimport { Path } from '../history/types';\r\n\r\nexport type LinkProps = {\r\n  component?: ComponentType<any>;\r\n  to: Partial<Location> | string | ((location: Location) => string | Partial<Location>);\r\n  replace?: boolean;\r\n  tag?: string;\r\n  /**\r\n   * @deprecated\r\n   * React16以后不再需要该属性\r\n   **/\r\n  innerRef?: Ref<HTMLAnchorElement>;\r\n} & { [key: string]: any };\r\n\r\nconst isModifiedEvent = (event: MouseEvent) => {\r\n  return event.metaKey || event.altKey || event.ctrlKey || event.shiftKey;\r\n};\r\n\r\nconst checkTarget = (target?: any) => {\r\n  return !target || target === '_self';\r\n};\r\n\r\n\r\nfunction Link<P extends LinkProps>(props: P) {\r\n  const { to, replace, component, onClick, target, ...other } = props;\r\n\r\n  const tag = props.tag || 'a';\r\n\r\n  const context = useContext(RouterContext);\r\n  const history = context.history;\r\n\r\n  let location = typeof to === 'function' ? to(context.location) : to;\r\n\r\n  let state: any;\r\n  let path: Partial<Path>;\r\n  if (typeof location === 'string') {\r\n    path = parsePath(location);\r\n  } else {\r\n    const { pathname, hash, search } = location;\r\n    path = { pathname, hash, search };\r\n    state = location.state;\r\n  }\r\n  const href = history.createHref(path);\r\n\r\n  const linkClickEvent = (event: MouseEvent<HTMLAnchorElement>) => {\r\n    try {\r\n      if (onClick) {\r\n        onClick(event);\r\n      }\r\n    } catch (e) {\r\n      event.preventDefault();\r\n      throw e;\r\n    }\r\n\r\n    if (!event.defaultPrevented && event.button === 0 && checkTarget(target) && !isModifiedEvent(event)) {\r\n      // 不是相同的路径执行push操作，是相同的路径执行replace\r\n      const isSamePath = createPath(context.location) === createPath(path);\r\n      const navigate = replace || isSamePath ? history.replace : history.push;\r\n      event.preventDefault();\r\n      navigate(path, state);\r\n    }\r\n  };\r\n\r\n  const linkProps = { href: href, onClick: linkClickEvent, ...other };\r\n  return Inula.createElement(tag, linkProps);\r\n}\r\n\r\nexport default Link;","import Inula from '@cloudsop/horizon';\r\nimport { useContext } from '@cloudsop/horizon';\r\nimport type { LinkProps } from './Link';\r\nimport Link from './Link';\r\nimport { Location, matchPath } from './index';\r\nimport { Matched } from '../matcher/parser';\r\nimport Context from './context';\r\nimport { parsePath } from '../history/utils';\r\n\r\ntype NavLinkProps = {\r\n  to: Partial<Location> | string | ((location: Location) => string | Partial<Location>);\r\n  isActive?<P extends { [K in keyof P]?: string }>(match: Matched<P> | null, location: Location): boolean;\r\n  exact?: boolean;\r\n  strict?: boolean;\r\n  sensitive?: boolean;\r\n  className?: string | ((isActive: boolean) => string);\r\n  activeClassName?: string;\r\n  // compat react-router NavLink props type\r\n  [key: string]: any;\r\n} & Omit<LinkProps, 'className'>;\r\n\r\ntype Page = 'page';\r\n\r\nfunction NavLink<P extends NavLinkProps>(props: P) {\r\n  const { to, isActive, exact, strict, sensitive, className, activeClassName, ...rest } = props;\r\n  const context = useContext(Context);\r\n\r\n  const toLocation = typeof to === 'function' ? to(context.location) : to;\r\n\r\n  const { pathname } = typeof toLocation === 'string' ? parsePath(toLocation) : toLocation;\r\n\r\n  const match = pathname\r\n    ? matchPath(context.location.pathname, pathname, {\r\n        exact: exact,\r\n        strictMode: strict,\r\n        caseSensitive: sensitive,\r\n      })\r\n    : null;\r\n\r\n  const isLinkActive = !!(isActive ? isActive(match, context.location) : match);\r\n\r\n  let classNames = typeof className === 'function' ? className(isLinkActive) : className;\r\n  if (isLinkActive) {\r\n    classNames = [activeClassName, classNames].filter(Boolean).join(' ');\r\n  }\r\n\r\n  const page: Page = 'page';\r\n  const otherProps = {\r\n    className: classNames,\r\n    'aria-current': isLinkActive ? page : undefined,\r\n    ...rest,\r\n  };\r\n\r\n  return <Link to={to} {...otherProps} />;\r\n}\r\n\r\nexport default NavLink;\r\n","import { Location } from '../router';\r\nimport { Action } from '../history/types';\r\n\r\n// 获取redux state中的值\r\nexport function getIn(state: Record<string, any>, path: string[]): any {\r\n  if (!state) {\r\n    return state;\r\n  }\r\n  const length = path.length;\r\n  if (!length) {\r\n    return undefined;\r\n  }\r\n  let res = state;\r\n  for (let i = 0; i < length && !!res; ++i) {\r\n    res = res[path[i]];\r\n  }\r\n  return res;\r\n}\r\n\r\n// 从store的state中获取Router、Location、Action、Hash等信息\r\nconst stateReader = (storeType: string) => {\r\n  const isRouter = (value: unknown) => {\r\n    return value !== null && typeof value === 'object' && !!getIn(value, ['location']) && !!getIn(value, ['action']);\r\n  };\r\n\r\n  const getRouter = (state: any) => {\r\n    const router = getIn(state, ['router']);\r\n    if (!isRouter(router)) {\r\n      throw new Error(`Could not find router reducer in ${storeType} store, it must be mounted under \"router\"`);\r\n    }\r\n    return router!;\r\n  };\r\n\r\n  const getLocation = <S>(state: any): Partial<Location<S>> => getIn(getRouter(state), ['location']);\r\n  const getAction = (state: any): Action => getIn(getRouter(state), ['action']);\r\n  const getSearch = (state: any): string => getIn(getRouter(state), ['location', 'search']);\r\n  const getHash = (state: any): string => getIn(getRouter(state), ['location', 'hash']);\r\n\r\n  return {\r\n    getHash,\r\n    getAction,\r\n    getSearch,\r\n    getRouter,\r\n    getLocation,\r\n  };\r\n};\r\n\r\nexport default stateReader","import Inula from '@cloudsop/horizon';\r\nimport { useLayoutEffect, useRef, reduxAdapter, InulaNode } from '@cloudsop/horizon';\r\nimport { connect, ReactReduxContext } from 'react-redux';\r\nimport type { Store } from 'redux';\r\nimport { History, Location, Router } from '../router';\r\nimport { Action, DefaultStateType, Navigation } from '../history/types';\r\nimport { ActionMessage, onLocationChanged } from './actions';\r\nimport stateReader from './reduxUtils';\r\n\r\ntype StoreType = 'InulaXCompat' | 'Redux';\r\n\r\ntype ConnectedRouter<S> = {\r\n  store: Store;\r\n  history: History<S>;\r\n  basename: string;\r\n  children?: (() => InulaNode) | InulaNode;\r\n  onLocationChanged: (location: Location<S>, action: Action, isFirstRendering: boolean) => ActionMessage;\r\n  noInitialPop: boolean;\r\n  omitRouter: boolean;\r\n  storeType: StoreType;\r\n};\r\n\r\nconst { connect: hConnect } = reduxAdapter;\r\n\r\nfunction ConnectedRouterWithoutMemo<S>(props: ConnectedRouter<S>) {\r\n  const { store, history, onLocationChanged, omitRouter, children, storeType } = props;\r\n  const { getLocation } = stateReader(storeType);\r\n\r\n  // 监听store变化\r\n  const unsubscribe = useRef<null | (() => void)>(\r\n    store.subscribe(() => {\r\n      // 获取redux State中的location信息\r\n      const {\r\n        pathname: pathnameInStore,\r\n        search: searchInStore,\r\n        hash: hashInStore,\r\n        state: stateInStore,\r\n      } = getLocation<S>(store.getState());\r\n\r\n      // 获取当前history对象中的location信息\r\n      const {\r\n        pathname: pathnameInHistory,\r\n        search: searchInHistory,\r\n        hash: hashInHistory,\r\n        state: stateInHistory,\r\n      } = history.location;\r\n\r\n      // 两个location不一致 执行跳转\r\n      if (\r\n        history.action === 'PUSH' &&\r\n        (pathnameInHistory !== pathnameInStore ||\r\n          searchInHistory !== searchInStore ||\r\n          hashInHistory !== hashInStore ||\r\n          stateInHistory !== stateInStore)\r\n      ) {\r\n        history.push(\r\n          {\r\n            pathname: pathnameInStore,\r\n            search: searchInStore,\r\n            hash: hashInStore,\r\n          },\r\n          stateInStore,\r\n        );\r\n      }\r\n    }),\r\n  );\r\n\r\n  const handleLocationChange = (args: Navigation<S>, isFirstRendering: boolean = false) => {\r\n    const { location, action } = args;\r\n    onLocationChanged(location, action, isFirstRendering);\r\n  };\r\n\r\n  // 监听history更新\r\n  const unListen = useRef<null | (() => void)>(history.listen(handleLocationChange));\r\n\r\n  useLayoutEffect(() => {\r\n    return () => {\r\n      unListen.current && unListen.current();\r\n      unsubscribe.current && unsubscribe.current();\r\n    };\r\n  }, []);\r\n\r\n  if (!props.noInitialPop) {\r\n    // 传递初始时位置信息，isFirstRendering设为true防止重复渲染\r\n    handleLocationChange({ location: history.location, action: history.action }, true);\r\n  }\r\n\r\n  if (omitRouter) {\r\n    return <>{children}</>;\r\n  }\r\n  let childrenNode: InulaNode;\r\n  if (typeof children === 'function') {\r\n    childrenNode = children();\r\n  } else {\r\n    childrenNode = children;\r\n  }\r\n\r\n  return <Router history={history}>{childrenNode}</Router>;\r\n}\r\n\r\nfunction getConnectedRouter<S = DefaultStateType>(type: StoreType) {\r\n  const mapDispatchToProps = (dispatch: any) => ({\r\n    onLocationChanged: (location: Location, action: Action, isFirstRendering: boolean) =>\r\n      dispatch(onLocationChanged(location, action, isFirstRendering)),\r\n  });\r\n  const ConnectedRouter = Inula.memo(ConnectedRouterWithoutMemo<S>);\r\n\r\n  const ConnectedRouterWithContext = (props: any) => {\r\n    const Context = props.context || ReactReduxContext;\r\n\r\n    return (\r\n      <Context.Consumer>\r\n        {({ store }: any) => <ConnectedRouter store={store} storeType={type} {...props} />}\r\n      </Context.Consumer>\r\n    );\r\n  };\r\n\r\n  const ConnectedHRouterWithContext = (props: any) => {\r\n    const { store, ...rest } = props;\r\n    return <ConnectedRouter store={store} storeType={type} {...rest} />;\r\n  };\r\n\r\n  // 针对不同的Store类型，使用对应的connect函数\r\n  if (type === 'InulaXCompat') {\r\n    return hConnect(null as any, mapDispatchToProps)(ConnectedHRouterWithContext as any);\r\n  }\r\n  if (type === 'Redux') {\r\n    return connect(null, mapDispatchToProps)(ConnectedRouterWithContext);\r\n  } else {\r\n    throw new Error('Invalid store type');\r\n  }\r\n}\r\n\r\nexport { getConnectedRouter };\r\n","import { ActionMessage, ActionName } from './actions';\r\nimport { History } from '../history/types';\r\n\r\n// 定义connect-router对应的redux dispatch函数\r\nexport function routerMiddleware(history: History) {\r\n  return function(_: any) {\r\n    return function(next: any) {\r\n      return function(action: ActionMessage) {\r\n        if (action.type !== ActionName.CALL_HISTORY_METHOD) {\r\n          return next(action);\r\n        }\r\n        const { payload: { method, args } } = action;\r\n        if (method in history) {\r\n          (history as any)[method](...args);\r\n        }\r\n      };\r\n    };\r\n  };\r\n}\r\n","import { createConnectRouter } from './reducer';\r\n\r\nexport { getConnectedRouter } from './connectedRouter';\r\nexport const connectRouter = createConnectRouter();\r\nexport { routerMiddleware } from './dispatch';\r\nexport { push, go, replace } from './actions';","import { Location as HLocation } from '../history/types';\r\nimport { getConnectedRouter } from '../connect-router';\r\n\r\ntype Location<S = unknown> = Omit<HLocation<S>, 'key'>;\r\n\r\n// ============================ history ============================\r\n\r\nexport type { Location };\r\nexport type { History } from '../history/types';\r\n\r\nexport { createBrowserHistory } from '../history/browerHistory';\r\nexport { createHashHistory } from '../history/hashHistory';\r\n\r\nexport { default as __RouterContext } from './context';\r\n\r\n// ============================ URL parser ============================\r\n\r\nexport { matchPath, generatePath } from '../matcher/parser';\r\n\r\n// ============================ Router Hooks ============================\r\n\r\nexport { useHistory, useLocation, useParams, useRouteMatch } from './hooks';\r\n\r\n// ============================ Router function component ============================\r\n\r\nexport { default as Route } from './Route';\r\nexport { default as Router } from './Router';\r\nexport { default as Switch } from './Switch';\r\nexport { default as Redirect } from './Redirect';\r\nexport { default as Prompt } from './Prompt';\r\nexport { default as withRouter } from './withRouter';\r\nexport { default as HashRouter } from './HashRouter';\r\nexport { default as BrowserRouter } from './BrowserRouter';\r\nexport { default as Link } from './Link';\r\nexport { default as NavLink } from './NavLink';\r\n\r\n// ============================ Router Types ============================\r\n\r\nexport type { RouteComponentProps, RouteChildrenProps, RouteProps } from './Route';\r\n\r\n// ============================ Connect-router ============================\r\n\r\nexport { connectRouter, routerMiddleware, push, go, replace } from '../connect-router';\r\nexport const ConnectedRouter = getConnectedRouter('Redux');\r\nexport const ConnectedHRouter = getConnectedRouter('InulaXCompat');\r\n"],"names":["_extends","Object","assign","bind","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","apply","ActionName","onLocationChanged","location","action","isFirstRendering","undefined","type","LOCATION_CHANGE","payload","updateLocation","method","_len","args","Array","_key","CALL_HISTORY_METHOD","push","replace","go","injectQueryParams","query","queryString","search","queryObject","params","URLSearchParams","forEach","value","createConnectRouter","history","initRouterState","state","_ref","_objectWithoutPropertiesLoose","excluded","sourceKeys","keys","indexOf","isBrowser","window","document","createElement","getDefaultConfirmation","message","callBack","confirm","isSupportHistory","isSupportsPopState","navigator","userAgent","Action","EventType","PopDirection","createPath","path","hash","pathname","startsWith","parsePath","url","parsedPath","hashIdx","substring","searchIdx","createLocation","current","to","urlObj","getRandKey","genRandomKey","parseRelativePath","isLocationEqual","p1","p2","addHeadSlash","stripHeadSlash","normalizeSlash","tempPath","hasBasename","prefix","toLowerCase","includes","charAt","stripBasename","createMemoryRecord","initVal","fn","visitedRecord","getDelta","from","toIdx","lastIndexOf","fromIdx","addRecord","newRecord","curVal","NewVal","prevIdx","newVisitedRecord","slice","end","Math","random","toString","fromParts","split","toParts","lastToPart","index","toIndex","urlPart","join","_classCallCheck","instance","Constructor","TypeError","_typeof","o","Symbol","iterator","constructor","toPrimitive","t","r","e","String","Number","toPropertyKey","_defineProperties","props","descriptor","enumerable","configurable","writable","defineProperty","_createClass","protoProps","staticProps","TransitionManager","prompt","setPrompt","_this","confirmJumpTo","userConfirmationFunc","result","warning","condition","console","warn","getBaseHistory","transitionManager","popActionListener","listenerCount","supportPopState","listeners","unListeners","browserHistory","pauseTrigger","step","triggerListener","setupListener","count","addEventListener","PopState","HashChange","removeEventListener","addListener","listener","isActive","wrapper","information","trigger","cancelListener","filter","destroy","_iterator","_createForOfIteratorHelper","_step","s","n","done","unListen","err","f","isBlocked","block","unblock","getUpdateStateFunc","historyProps","nextState","originPath","delta","commonArgs","popArgs","direction","forward","back","pop","createBrowserHistory","options","supportHistory","isSupportPopState","_options$forceRefresh","forceRefresh","_options$getUserConfi","getUserConfirmation","basename","initLocation","getLocation","getHistoryState","recordOperator","l","_getBaseHistory","handlePop","listen","goBack","goForward","createHref","updateState","historyState","_window$location","forceJump","handlePopState","callback","isJump","revertPopState","isEventPopState","event","handler","locationHandler","baseHandler","href","pushState","replaceState","stripHash","idx","getHashContent","createHashHistory","option","_option$hashType","hashType","_option$getUserConfir","pathDecoder","pathEncoder","startLocation","encodedLocation","hashPath","memRecords","tag","querySelector","base","getAttribute","forceNextPop","ignorePath","handleHashChange","encodedPath","prevLocation","createNamedContext","name","defaultValue","context","createContext","displayName","RouterContext","TokenType","cleanPath","scoreCompare","score1","score2","score1Length","score2Length","min","escapeStr","str","validChar","lexer","tokens","urlPath","Error","getLiteral","test","skipChar","curChar","prevChar","Delimiter","Param","WildCard","Static","LBracket","RBracket","Pattern","MatchScore","defaultOption","caseSensitive","strictMode","exact","REGEX_CHARS_RE","BASE_PARAM_PATTERN","DefaultDelimiter","createPathParser","_option$caseSensitive","_option$strictMode","_option$exact","pattern","scores","onlyHasWildCard","tokenCount","lastToken","asteriskCount","lookToNextDelimiter","currentIdx","hasOptionalParam","tokenIdx","token","nextToken","hasOptional","isSlashOptional","static","paramRegexp","param","wildcard","placeholder","isWildCard","flag","regexp","RegExp","parse","reMatch","match","matchedPath","parseScore","isArray","_params$","splice","concat","fill","isExact","score","compile","wildCard","matchPath","patterns","matchedResults","_iterator2","_step2","item","parser","matched","sort","a","b","generatePath","useHistory","useContext","useLocation","useParams","useRouteMatch","Route","computed","component","render","strict","sensitive","children","routeLocation","newProps","Children","getChildren","_jsx","Provider","Router","_props$children","_useState","useState","setLocation","pendingLocation","useRef","isMount","arg","useLayoutEffect","initContextValue","useMemo","Switch","element","node","isValidElement","elementProps","cloneElement","LifeCycle","prevProps","onMount","onUpdate","onUnmount","Redirect","_props$push","calcLocation","navigate","_calcLocation","_excluded","onMountFunc","onUpdateFunc","prevPath","data","Prompt","_props$when","when","release","onUnmountFunc","withRouter","Component","wrappedComponentRef","rest","ref","HashRouter","historyRef","BrowserRouter","isModifiedEvent","metaKey","altKey","ctrlKey","shiftKey","checkTarget","Link","onClick","other","linkClickEvent","preventDefault","defaultPrevented","button","isSamePath","linkProps","Inula","NavLink","className","activeClassName","Context","toLocation","isLinkActive","classNames","Boolean","page","otherProps","getIn","res","stateReader","storeType","isRouter","getRouter","router","getAction","getSearch","getHash","hConnect","reduxAdapter","connect","ConnectedRouterWithoutMemo","store","omitRouter","_stateReader","unsubscribe","subscribe","_getLocation","getState","pathnameInStore","searchInStore","hashInStore","stateInStore","_history$location","pathnameInHistory","searchInHistory","hashInHistory","stateInHistory","handleLocationChange","noInitialPop","_Fragment","childrenNode","getConnectedRouter","mapDispatchToProps","dispatch","ConnectedRouter","memo","ConnectedRouterWithContext","ReactReduxContext","Consumer","ConnectedHRouterWithContext","routerMiddleware","_","next","_action$payload","connectRouter","ConnectedHRouter"],"mappings":"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"}